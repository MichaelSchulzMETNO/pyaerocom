

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorials (Jupyter Notebooks) &mdash; pyaerocom  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pyaerocom  documentation" href="index.html"/>
        <link rel="next" title="API" href="api.html"/>
        <link rel="prev" title="Introduction" href="readme.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pyaerocom
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#documentation">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#installation">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorials (Jupyter Notebooks)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-the-paths-for-data-import-and-output">Setting-up the paths for data import and output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#browsing-the-database">Browsing the database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#working-locally-changing-the-paths">Working locally (Changing the paths)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-the-aerosol-optical-detph-at-550nm-using-a-specified-model-id">Reading the aerosol optical detph at 550nm using a specified model ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-the-data-and-plotting-a-map">Accessing the data and plotting a map</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aerocom-default-regions">AEROCOM default regions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#load-example-data-and-apply-region-specific-crop">Load example data and apply region specific crop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-model-data-the-readgridded-class">Reading model data: the <em>ReadGridded</em> class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#remark-on-time-definition">Remark on time definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-very-brief-introduction-into-the-griddeddata-class">A very brief introduction into the GriddedData class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-data-from-multiple-models-the-readgriddedmulti-class">Reading data from multiple models: the ReadGriddedMulti class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#iterate-over-models-and-variables">Iterate over models and variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#introducing-the-griddeddata-class">Introducing the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#remark-on-longitude-definition">Remark on longitude definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#features-of-the-griddeddata-class">Features of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#more-to-come">… more to come</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#colocating-gridded-data-with-discrete-observations">Colocating gridded data with discrete observations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#note">NOTE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-setup-and-imports">Import setup and imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-of-model-data">Import of model data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-of-aeronet-sun-v3-data-level-2">Import of AeroNet Sun V3 data (Level 2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#now-perform-collocation-and-plot-corresponding-scatter-plots-with-statistical-values">Now perform collocation and plot corresponding scatter plots with statistical values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#monthly-world-no-mountains">2010 monthly World no mountains</a></li>
<li class="toctree-l4"><a class="reference internal" href="#daily-europe-no-mountains">2010 daily Europe no mountains</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#handling-of-time-in-pyaerocom">Handling of time in pyaerocom</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#load-and-some-example-data">Load and some example data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#digging-into-the-time-representation-of-the-iris-cube-datatype">Digging into the time representation of the iris Cube datatype</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#peculiarities-of-time-handling-when-using-the-cube-interface">Peculiarities of time handling when using the <code class="docutils literal notranslate"><span class="pre">Cube</span></code> interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-options-to-convert-timestamps">Other options to convert timestamps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#how-pya-does-it">How pya does it</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-showing-how-to-read-ebas-nasa-ames-files">Tutorial showing how to read EBAS NASA Ames files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#column-information">Column information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#access-flag-information">Access flag information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convert-object-to-pandas-dataframe">Convert object to pandas Dataframe</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ebas-file-query-and-database-browser">EBAS file query and database browser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#specifying-a-request">Specifying a request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execution-of-file-request-query">Execution of file request query</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Browsing the database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-browsing">Custom browsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-all-files">Read all files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_testsuite.html">Tests (for developers)</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_files.html">Configuration files</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyaerocom</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Tutorials (Jupyter Notebooks)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tutorials.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="tutorials-jupyter-notebooks">
<h1>Tutorials (Jupyter Notebooks)<a class="headerlink" href="#tutorials-jupyter-notebooks" title="Permalink to this headline">¶</a></h1>
<p>In this section you can find example tutorial notebooks for Pyaerocom.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Under development</p>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>This notebook gives an introduction on how to install pyaerocom and run
it on your local machine.</p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>Before installation please make sure you have all required dependencies
installed (<a class="reference external" href="http://aerocom.met.no/pyaerocom/readme.html#requirements">see here for a list of
dependencies</a>).</p>
</div>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>Please download and unzip the <a class="reference external" href="https://github.com/metno/pyaerocom">pyaerocom GitHub
repository</a> or clone it using</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/metno/pyaerocom.git</span></code></p>
<p>into a local directory of your choice. Then, navigate into the pyaerocom
root directory where the setup.py file is located. Use</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code></p>
<p>to install the package normally or use</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">develop</span></code></p>
<p>to install the package in development mode. The latter leaves the code
editable and while <code class="docutils literal notranslate"><span class="pre">install</span></code> installs and freezes the current version
of the code in your Python environment (<a class="reference external" href="https://packaging.python.org/tutorials/distributing-packages/#working-in-development-mode">see
here</a>
or
<a class="reference external" href="https://stackoverflow.com/questions/19048732/python-setup-py-develop-vs-install">here</a>
for more info).</p>
<p>If everything worked out as expected, you should be able to import
pyaerocom from within a Python3 console.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Installation base directory: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">pya</span>.__dir__)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Version: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">pya</span>.__version__)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">977</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">basemap</span> <span class="n">extension</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">installed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">imported</span><span class="o">.</span> <span class="n">Some</span> <span class="n">features</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">available</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="mi">789</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">geopy</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span><span class="o">.</span> <span class="n">Aeolus</span> <span class="n">data</span> <span class="n">read</span> <span class="ow">not</span> <span class="n">enabled</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Installation</span> <span class="n">base</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">pyaerocom</span><span class="o">/</span><span class="n">pyaerocom</span>
<span class="n">Version</span><span class="p">:</span> <span class="mf">0.3</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-up-the-paths-for-data-import-and-output">
<h3>Setting-up the paths for data import and output<a class="headerlink" href="#setting-up-the-paths-for-data-import-and-output" title="Permalink to this headline">¶</a></h3>
<p>The import of data from the AEROCOM database in pyaerocom is controlled
via an instance of the <code class="docutils literal notranslate"><span class="pre">Config</span></code> class. The attribute <code class="docutils literal notranslate"><span class="pre">const</span></code> of
pyaerocom returns the current configuration.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">Config</span>
<span class="o">----------------</span>

<span class="n">_config_ini</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">pyaerocom</span><span class="o">/</span><span class="n">pyaerocom</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">paths</span><span class="o">.</span><span class="n">ini</span>
<span class="n">_modelbasedir</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span>
<span class="n">_obsbasedir</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span>
<span class="n">_cachedir</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">pyaerocom</span><span class="o">/</span><span class="n">_cache</span>
<span class="n">_outputdir</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">pyaerocom</span>
<span class="n">_caching_active</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">_var_param</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">GRID_IO</span><span class="p">:</span>
<span class="n">Pyaerocom</span> <span class="n">GridIO</span>
<span class="o">----------------</span>

   <span class="n">FILE_TYPE</span><span class="p">:</span> <span class="o">.</span><span class="n">nc</span>
   <span class="n">TS_TYPES</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">5</span> <span class="n">items</span><span class="p">)</span>
   <span class="p">[</span><span class="s1">&#39;hourly&#39;</span>
    <span class="s1">&#39;3hourly&#39;</span>
    <span class="o">...</span>
    <span class="s1">&#39;monthly&#39;</span>
    <span class="s1">&#39;yearly&#39;</span><span class="p">]</span>

   <span class="n">DEL_TIME_BOUNDS</span><span class="p">:</span> <span class="kc">True</span>
   <span class="n">SHIFT_LONS</span><span class="p">:</span> <span class="kc">True</span>
   <span class="n">CHECK_TIME_FILENAME</span><span class="p">:</span> <span class="kc">True</span>
   <span class="n">CORRECT_TIME_FILENAME</span><span class="p">:</span> <span class="kc">True</span>
   <span class="n">CHECK_DIM_COORDS</span><span class="p">:</span> <span class="kc">False</span>
   <span class="n">EQUALISE_METADATA</span><span class="p">:</span> <span class="kc">True</span>
   <span class="n">USE_RENAMED_DIR</span><span class="p">:</span> <span class="kc">True</span>
   <span class="n">INCLUDE_SUBDIRS</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">OBSCONFIG</span> <span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
<span class="n">MODELDIRS</span> <span class="p">(</span><span class="nb">list</span><span class="p">)</span>
   <span class="p">[</span><span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/&#39;</span>
    <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom2/&#39;</span>
    <span class="o">...</span>
    <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-II-IND3/&#39;</span>
    <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-II-IND2/&#39;</span><span class="p">]</span>

<span class="n">WRITE_FILEIO_ERR_LOG</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">AERONET_SUN_V2L15_AOD_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetSunV2Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span>
<span class="n">AERONET_SUN_V2L15_AOD_ALL_POINTS_NAME</span><span class="p">:</span> <span class="n">AeronetSun_2</span><span class="o">.</span><span class="mi">0</span><span class="n">_NRT</span>
<span class="n">AERONET_SUN_V2L2_AOD_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetSunV2Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">AERONET_SUN_V2L2_AOD_ALL_POINTS_NAME</span><span class="p">:</span> <span class="n">AeronetSunV2Lev2</span><span class="o">.</span><span class="n">AP</span>
<span class="n">AERONET_SUN_V2L2_SDA_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetSDAV2Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">AERONET_SUN_V2L2_SDA_ALL_POINTS_NAME</span><span class="p">:</span> <span class="n">AeronetSDAV2Lev2</span><span class="o">.</span><span class="n">AP</span>
<span class="n">AERONET_INV_V2L15_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetInvV2Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span>
<span class="n">AERONET_INV_V2L15_ALL_POINTS_NAME</span><span class="p">:</span> <span class="n">AeronetInvV2Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">AP</span>
<span class="n">AERONET_INV_V2L2_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetInvV2Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">AERONET_INV_V2L2_ALL_POINTS_NAME</span><span class="p">:</span> <span class="n">AeronetInvV2Lev2</span><span class="o">.</span><span class="n">AP</span>
<span class="n">AERONET_SUN_V3L15_AOD_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetSunV3Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span>
<span class="n">AERONET_SUN_V3L15_AOD_ALL_POINTS_NAME</span><span class="p">:</span> <span class="n">AeronetSunV3Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">AP</span>
<span class="n">AERONET_SUN_V3L2_AOD_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">AERONET_SUN_V3L2_AOD_ALL_POINTS_NAME</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">AP</span>
<span class="n">AERONET_SUN_V3L2_SDA_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetSDAV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">AERONET_SUN_V3L2_SDA_ALL_POINTS_NAME</span><span class="p">:</span> <span class="n">AeronetSDAV3Lev2</span><span class="o">.</span><span class="n">AP</span>
<span class="n">AERONET_INV_V3L15_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetInvV3Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span>
<span class="n">AERONET_INV_V3L2_DAILY_NAME</span><span class="p">:</span> <span class="n">AeronetInvV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">EBAS_MULTICOLUMN_NAME</span><span class="p">:</span> <span class="n">EBASMC</span>
<span class="n">EEA_NAME</span><span class="p">:</span> <span class="n">EEAAQeRep</span>
<span class="n">EARLINET_NAME</span><span class="p">:</span> <span class="n">EARLINET</span>
<span class="n">DONOTCACHEFILE</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">pyaerocom</span><span class="o">/</span><span class="n">_cache</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">DONOTCACHE</span>
</pre></div>
</div>
<p>You can check if the relevant base directories <code class="docutils literal notranslate"><span class="pre">MODELBASEDIR</span></code> and
<code class="docutils literal notranslate"><span class="pre">OBSBASEDIR</span></code> are valid.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Base paths valid? </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">pya</span>.const.READY)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Base paths valid? True
</pre></div>
</div>
<p>The base directory for the databse search is:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">BASEDIR</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;/lustre/storeA/project/aerocom/&#39;</span>
</pre></div>
</div>
<p>And the search directories for model and obs data are relative to the
base directory. They can be accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">MODELDIRS</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom2/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/C3S-Aerosol&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/ECLIPSE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/SATELLITE-DATA/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/CCI-Aerosol/CCI_AEROSOL_Phase2/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/ACCMIP/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/ECMWF/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom2/EMEP_COPERNICUS/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom2/EMEP/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom2/EMEP_GLOBAL/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom2/EMEP_SVN_TEST/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom2/NorESM_SVN_TEST/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom2/INCA/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/HTAP-PHASE-I/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/HTAP-PHASE-II/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-I/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-II/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-III/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-III-Trend/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/CCI-Aerosol/CCI_AEROSOL_Phase1/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-II-IND3/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-II-IND2/&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>And:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">OBSDIRS</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;/lustre/storeA/project/aerocom/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetSunNRT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetRaw2.0/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetSun2.0AllPoints/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetSun2.0.SDA.daily/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetSun2.0.SDA.AP/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetSunV3Lev1.5.daily/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetSunV3Lev1.5.AP/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetSunV3Lev2.0.daily/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetSunV3Lev2.0.AP/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/Aeronet.SDA.V3L1.5.daily/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/Aeronet.SDA.V3L2.0.daily/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/Aeronet.Inv.V2L1.5.daily/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/Aeronet.Inv.V2L2.0.daily/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/Aeronet.Inv.V3L1.5.daily/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/Aeronet.Inv.V3L2.0.daily/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/EBASMultiColumn/data&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/EEA_AQeRep/renamed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/Earlinet/data&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>On init, these are set to default directories (assuming to have access
to the Aerocom database). All subdirectories (relative to <code class="docutils literal notranslate"><span class="pre">BASEDIR</span></code>)
that are not available are removed. So, what is returned when calling
the previous commands, is the directories that are accessible. If you
work locally and do not resemble this database structure, these 2 lists
will be likely empty. See below for instructions on how to set up
pyaerocom when working locally.</p>
</div>
<div class="section" id="browsing-the-database">
<h3>Browsing the database<a class="headerlink" href="#browsing-the-database" title="Permalink to this headline">¶</a></h3>
<p>Based on the defined paths, pyaerocom searches for data. Now, assuming
there is access to the database, you can use the <code class="docutils literal notranslate"><span class="pre">browse_database</span></code>
method to search for available model or observational data using
<a class="reference external" href="https://en.wikipedia.org/wiki/Wildcard_character">wildcard search</a>.
For instance, if you are interseted in data from MET Oslo, you can
e.g.&nbsp;search:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;CAM5*Oslo*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Found</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">20</span> <span class="n">matches</span> <span class="k">for</span> <span class="n">based</span> <span class="n">on</span> <span class="nb">input</span> <span class="n">string</span> <span class="n">CAM5</span><span class="o">*</span><span class="n">Oslo</span><span class="o">*</span><span class="p">:</span>

<span class="n">Matches</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CAM53-Oslo_cdaeb5e_MG15CLM45_7oct2016IHK_2006-2014&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PI_UNTUNED&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5-Oslo_TEST-emi2000&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_re9f8_MG15CLM45_4feb2016AK_PD_MG15MegVadSOA&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_r470Nudge_150315AG_BF1NudgePD2000&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_7310_MG15CLM45_5feb2017AG_7310Nudge2000&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_r610Nudge_011015AK_SOA_r610_PD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_6b76dca_MG15CLM45_22aug2016AK_PDaug16UVPSndg&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_r34afMG15CLM45_160120AG_34af_megan_2000_NDG&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_r773bNudge_151215AG_PD_DMS_733b&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_r512Nudge_150315AK_PD2000nudged&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_r670Nudge_011115AG_R670_PD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_7310_MG15CLM45_5feb2017AG_7310AMIP1850V&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_cdaeb5e_MG15CLM45_7oct2016IHK_ERA_2001-2015&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_20161109AK_ERAndg&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5.3-Oslo_MG15CLM45_10jun2017_AK_2005-2010&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM53-Oslo_7310_MG15CLM45_5feb2017AG_7310AMIP20002&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5-Oslo_FAMIPWARMCnudge-emi2000.A2.CTRL&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5.3-Oslo_INSITU&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5.3-Oslo_CTRL2016&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5.3-Oslo_AP3-CTRL2016-PD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5.3-Oslo_AP3-CTRL2016-PI&#39;</span><span class="p">]</span>

<span class="n">To</span> <span class="n">receive</span> <span class="n">more</span> <span class="n">detailed</span> <span class="n">information</span><span class="p">,</span> <span class="n">please</span> <span class="n">specify</span> <span class="n">search</span> <span class="n">ID</span> <span class="n">more</span> <span class="n">accurately</span>
</pre></div>
</div>
<p>Then, if you find something you are interested in, you can read the data
using the <code class="docutils literal notranslate"><span class="pre">pyaerocom.ReadGridded</span></code> class (which will be introduced in
more detail later). For instance:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="s1">&#39;CAM5.3-Oslo_CTRL2016&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The print() method get’s you some more info about what is in there, that
is, available variables, years and temporal resolutions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;deltaz3d&#39;</span><span class="p">,</span> <span class="s1">&#39;humidity3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;3hourly&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="working-locally-changing-the-paths">
<h3>Working locally (Changing the paths)<a class="headerlink" href="#working-locally-changing-the-paths" title="Permalink to this headline">¶</a></h3>
<p>If you work on your local machine and you use the external AEROCOM user
server, you might need to change the path settings. The easiest way to
do this is to update the base directory where pyaerocom searches for
models.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">BASEDIR</span> <span class="o">=</span> <span class="s1">&#39;/home/&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">C3S</span><span class="o">-</span><span class="n">Aerosol</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECLIPSE</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">SATELLITE</span><span class="o">-</span><span class="n">DATA</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">CCI</span><span class="o">-</span><span class="n">Aerosol</span><span class="o">/</span><span class="n">CCI_AEROSOL_Phase2</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ACCMIP</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">EMEP_COPERNICUS</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">EMEP</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">EMEP_GLOBAL</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">EMEP_SVN_TEST</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">NorESM_SVN_TEST</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">INCA</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">HTAP</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">I</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">HTAP</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">II</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">I</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">II</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">-</span><span class="n">Trend</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">CCI</span><span class="o">-</span><span class="n">Aerosol</span><span class="o">/</span><span class="n">CCI_AEROSOL_Phase1</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">II</span><span class="o">-</span><span class="n">IND3</span><span class="o">/</span>
<span class="n">Model</span> <span class="n">directory</span> <span class="n">base</span> <span class="n">path</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">search</span> <span class="n">tree</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">II</span><span class="o">-</span><span class="n">IND2</span><span class="o">/</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunNRT</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetRaw2</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mi">0</span><span class="n">AllPoints</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">SDA</span><span class="o">.</span><span class="n">V3L1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">SDA</span><span class="o">.</span><span class="n">V3L2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">Inv</span><span class="o">.</span><span class="n">V2L1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">Inv</span><span class="o">.</span><span class="n">V2L2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">Inv</span><span class="o">.</span><span class="n">V3L1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">Inv</span><span class="o">.</span><span class="n">V3L2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">EBASMultiColumn</span><span class="o">/</span><span class="n">data</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">EEA_AQeRep</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Earlinet</span><span class="o">/</span><span class="n">data</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
</pre></div>
</div>
<p>Now, since there is actually nothing below this base directory that
matches the predefined search patterns, the list specifying search
directories is empty.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">MODELDIRS</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-the-aerosol-optical-detph-at-550nm-using-a-specified-model-id">
<h3>Reading the aerosol optical detph at 550nm using a specified model ID<a class="headerlink" href="#reading-the-aerosol-optical-detph-at-550nm-using-a-specified-model-id" title="Permalink to this headline">¶</a></h3>
<p>The resulting list shows possible options that were found in the
database. Let’s choose the <em>CAM5.3-Oslo_CTRL2016</em> run and import the
data. In the following cell, we directly instantiate a read class for
data import since we know the model and run ID from the previous cell
(the read class basically includes the above used search method).</p>
<p>Before we can read from the database, we have to reset the paths in the
configuration.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">keep_basedirs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">READY</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">read</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="s2">&quot;CAM5.3-Oslo_CTRL2016&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Okay, let’s see what is in there.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;deltaz3d&#39;</span><span class="p">,</span> <span class="s1">&#39;humidity3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;3hourly&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Let’s load results for the aerosol optical depth (<em>od550aer</em>) for march
2010. The read function take a string or a list of strings as input for
specifying one or more variables that are supposed to be read. Thus, the
return type of this method is <strong>always a tuple, even if we only provide
one variable</strong> (as in the following example) and as a result, the loaded
data object has to be accessed using the first index of the tuple.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">read</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;1 march 2010&quot;</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="s2">&quot;31 march 2010&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-the-data-and-plotting-a-map">
<h3>Accessing the data and plotting a map<a class="headerlink" href="#accessing-the-data-and-plotting-a-map" title="Permalink to this headline">¶</a></h3>
<p>The loaded data is of type <em>GriddedData</em> and can now be used for further
analysis. It’s string representation contains a useful summary of what
is in there.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pyaerocom.GriddedData: CAM5.3-Oslo_CTRL2016
Grid data: Aerosol optical depth at 550nm / (1) (time: 248; latitude: 192; longitude: 288)
     Dimension coordinates:
          time                            x              -               -
          latitude                        -              x               -
          longitude                       -              -               x
     Attributes:
          Conventions: CF-1.0
          NCO: 4.3.7
          Version: $Name$
          case: optINSITUnRemote
          history: Wed Feb  8 11:55:24 2017: ncatted -O -a units,od550aer,o,c,1 TMPmnth_od550aer.2010-01.nc
Wed...
          host: r10i0n0
          initial_file: /work/shared/noresm/inputdata/atm/cam/inic/fv/cami-mam3_0000-01-01_0.9...
          logname: kirkevag
          nco_openmp_thread_number: 1
          revision_Id: $Id$
          source: CAM
          title: UNSET
          topography_file: /work/shared/noresm/inputdata/noresm-only/inputForNudging/ERA_f09f09_3...
</pre></div>
</div>
<p>The data comprises 31 time stamps, as expected, since we picked one
month and the dataset is daily. Now, for instance, we can crop the data
using a predefined region (e.g.&nbsp;South America) and plot the first day of
the dataset.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;SAMERICA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">time_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_33_0.png" src="_images/tut00_get_started_33_0.png" />
<p>We might also be interested in the weighted area average for the month
that we extracted.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weighted_mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">area_weighted_mean</span><span class="p">()</span>
<span class="n">weighted_mean</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">analysis</span><span class="o">/</span><span class="n">cartography</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">377</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Using</span> <span class="n">DEFAULT_SPHERICAL_EARTH_RADIUS</span><span class="o">.</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Using DEFAULT_SPHERICAL_EARTH_RADIUS.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">masked_array</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">0.13707124521646233</span><span class="p">,</span> <span class="mf">0.1373723321458452</span><span class="p">,</span>
                   <span class="mf">0.13640485953205256</span><span class="p">,</span> <span class="mf">0.13661781887097216</span><span class="p">,</span>
                   <span class="mf">0.13832752529888542</span><span class="p">,</span> <span class="mf">0.13943940046228157</span><span class="p">,</span>
                   <span class="mf">0.13906411166070964</span><span class="p">,</span> <span class="mf">0.13903393246626614</span><span class="p">,</span>
                   <span class="mf">0.1389572414826536</span><span class="p">,</span> <span class="mf">0.1387749384645807</span><span class="p">,</span>
                   <span class="mf">0.13859131867159108</span><span class="p">,</span> <span class="mf">0.1392616918989809</span><span class="p">,</span>
                   <span class="mf">0.14148057496888855</span><span class="p">,</span> <span class="mf">0.14422837963496726</span><span class="p">,</span>
                   <span class="mf">0.14485939091969455</span><span class="p">,</span> <span class="mf">0.14382647033828228</span><span class="p">,</span>
                   <span class="mf">0.1429247987684401</span><span class="p">,</span> <span class="mf">0.14132091948668582</span><span class="p">,</span>
                   <span class="mf">0.13963221183937138</span><span class="p">,</span> <span class="mf">0.13899722350877253</span><span class="p">,</span>
                   <span class="mf">0.1397316309699972</span><span class="p">,</span> <span class="mf">0.140429463344697</span><span class="p">,</span>
                   <span class="mf">0.13979820277861796</span><span class="p">,</span> <span class="mf">0.13931129118926358</span><span class="p">,</span>
                   <span class="mf">0.1382730558010573</span><span class="p">,</span> <span class="mf">0.13705837683541341</span><span class="p">,</span>
                   <span class="mf">0.13626943214697504</span><span class="p">,</span> <span class="mf">0.13656861866930264</span><span class="p">,</span>
                   <span class="mf">0.13828947462737487</span><span class="p">,</span> <span class="mf">0.13862655803764867</span><span class="p">,</span>
                   <span class="mf">0.13801004090860575</span><span class="p">,</span> <span class="mf">0.13816556759043425</span><span class="p">,</span>
                   <span class="mf">0.13891506072795737</span><span class="p">,</span> <span class="mf">0.13885491398159325</span><span class="p">,</span>
                   <span class="mf">0.13791297848698755</span><span class="p">,</span> <span class="mf">0.13786872604208614</span><span class="p">,</span>
                   <span class="mf">0.1383256634671104</span><span class="p">,</span> <span class="mf">0.13802173506964452</span><span class="p">,</span>
                   <span class="mf">0.13734295888393036</span><span class="p">,</span> <span class="mf">0.13670887870882611</span><span class="p">,</span>
                   <span class="mf">0.13583143441388867</span><span class="p">,</span> <span class="mf">0.134603109796585</span><span class="p">,</span>
                   <span class="mf">0.1333276946610027</span><span class="p">,</span> <span class="mf">0.13244025688660607</span><span class="p">,</span>
                   <span class="mf">0.13297618583370702</span><span class="p">,</span> <span class="mf">0.13337864744931724</span><span class="p">,</span>
                   <span class="mf">0.13325346476065494</span><span class="p">,</span> <span class="mf">0.13273727817161787</span><span class="p">,</span>
                   <span class="mf">0.13272747346724398</span><span class="p">,</span> <span class="mf">0.1333092276404929</span><span class="p">,</span>
                   <span class="mf">0.1333797519133725</span><span class="p">,</span> <span class="mf">0.13433262445580588</span><span class="p">,</span>
                   <span class="mf">0.13693531065433906</span><span class="p">,</span> <span class="mf">0.13957995569444528</span><span class="p">,</span>
                   <span class="mf">0.13962851699132414</span><span class="p">,</span> <span class="mf">0.13859857966249953</span><span class="p">,</span>
                   <span class="mf">0.13791145087797585</span><span class="p">,</span> <span class="mf">0.13739929473269538</span><span class="p">,</span>
                   <span class="mf">0.13723982261191392</span><span class="p">,</span> <span class="mf">0.1380459466011261</span><span class="p">,</span>
                   <span class="mf">0.13946419690290854</span><span class="p">,</span> <span class="mf">0.14042819240907664</span><span class="p">,</span>
                   <span class="mf">0.13931406757480316</span><span class="p">,</span> <span class="mf">0.13866676878977408</span><span class="p">,</span>
                   <span class="mf">0.13822170463985428</span><span class="p">,</span> <span class="mf">0.13778772182438</span><span class="p">,</span>
                   <span class="mf">0.13651838547716436</span><span class="p">,</span> <span class="mf">0.13615014242990736</span><span class="p">,</span>
                   <span class="mf">0.13744348000076528</span><span class="p">,</span> <span class="mf">0.13995109480361492</span><span class="p">,</span>
                   <span class="mf">0.1411970413507769</span><span class="p">,</span> <span class="mf">0.14199804429653667</span><span class="p">,</span>
                   <span class="mf">0.14258413847594195</span><span class="p">,</span> <span class="mf">0.14220802982119984</span><span class="p">,</span>
                   <span class="mf">0.14140121976767336</span><span class="p">,</span> <span class="mf">0.14120394722823995</span><span class="p">,</span>
                   <span class="mf">0.14162688135139243</span><span class="p">,</span> <span class="mf">0.14188006322900268</span><span class="p">,</span>
                   <span class="mf">0.1414684469806162</span><span class="p">,</span> <span class="mf">0.14223318292711828</span><span class="p">,</span>
                   <span class="mf">0.14334570700875637</span><span class="p">,</span> <span class="mf">0.14337269717823287</span><span class="p">,</span>
                   <span class="mf">0.1421074317050635</span><span class="p">,</span> <span class="mf">0.14175130499968785</span><span class="p">,</span>
                   <span class="mf">0.14035452134831083</span><span class="p">,</span> <span class="mf">0.1388756394628699</span><span class="p">,</span>
                   <span class="mf">0.13762539366487916</span><span class="p">,</span> <span class="mf">0.13717837639346694</span><span class="p">,</span>
                   <span class="mf">0.13737289737903915</span><span class="p">,</span> <span class="mf">0.13747045610992034</span><span class="p">,</span>
                   <span class="mf">0.13745494956066656</span><span class="p">,</span> <span class="mf">0.1378100303636898</span><span class="p">,</span>
                   <span class="mf">0.1382755441221473</span><span class="p">,</span> <span class="mf">0.13892579338926514</span><span class="p">,</span>
                   <span class="mf">0.13933988912083564</span><span class="p">,</span> <span class="mf">0.14051427623407034</span><span class="p">,</span>
                   <span class="mf">0.142736023510284</span><span class="p">,</span> <span class="mf">0.14312065245179398</span><span class="p">,</span>
                   <span class="mf">0.14234607987063616</span><span class="p">,</span> <span class="mf">0.14275634737217646</span><span class="p">,</span>
                   <span class="mf">0.1437991330395562</span><span class="p">,</span> <span class="mf">0.14502984115661513</span><span class="p">,</span>
                   <span class="mf">0.14599941360148747</span><span class="p">,</span> <span class="mf">0.14601582462470347</span><span class="p">,</span>
                   <span class="mf">0.14640728011839496</span><span class="p">,</span> <span class="mf">0.14610034153933943</span><span class="p">,</span>
                   <span class="mf">0.14537368722625044</span><span class="p">,</span> <span class="mf">0.14578767727711434</span><span class="p">,</span>
                   <span class="mf">0.14607726598563622</span><span class="p">,</span> <span class="mf">0.14605008459289356</span><span class="p">,</span>
                   <span class="mf">0.1460609898662843</span><span class="p">,</span> <span class="mf">0.14703622375646566</span><span class="p">,</span>
                   <span class="mf">0.1478730521106064</span><span class="p">,</span> <span class="mf">0.14803795993760244</span><span class="p">,</span>
                   <span class="mf">0.14711712713761174</span><span class="p">,</span> <span class="mf">0.14729376248796983</span><span class="p">,</span>
                   <span class="mf">0.14851956275002343</span><span class="p">,</span> <span class="mf">0.14967160487601566</span><span class="p">,</span>
                   <span class="mf">0.14983351441403536</span><span class="p">,</span> <span class="mf">0.1495072510640238</span><span class="p">,</span>
                   <span class="mf">0.14926850286432325</span><span class="p">,</span> <span class="mf">0.14944789863237368</span><span class="p">,</span>
                   <span class="mf">0.14876039934421642</span><span class="p">,</span> <span class="mf">0.1488120453274109</span><span class="p">,</span>
                   <span class="mf">0.1498588856911828</span><span class="p">,</span> <span class="mf">0.15175075392107956</span><span class="p">,</span>
                   <span class="mf">0.15258806488973015</span><span class="p">,</span> <span class="mf">0.15286511152135315</span><span class="p">,</span>
                   <span class="mf">0.15386619169423127</span><span class="p">,</span> <span class="mf">0.15464113549871336</span><span class="p">,</span>
                   <span class="mf">0.15379449982944376</span><span class="p">,</span> <span class="mf">0.1543578549941653</span><span class="p">,</span>
                   <span class="mf">0.15808873311045932</span><span class="p">,</span> <span class="mf">0.16173720799971888</span><span class="p">,</span>
                   <span class="mf">0.16307998367790294</span><span class="p">,</span> <span class="mf">0.16233174812565518</span><span class="p">,</span>
                   <span class="mf">0.1622602797752089</span><span class="p">,</span> <span class="mf">0.16177535638150164</span><span class="p">,</span>
                   <span class="mf">0.16164991550698743</span><span class="p">,</span> <span class="mf">0.16343753440952663</span><span class="p">,</span>
                   <span class="mf">0.16855594710934646</span><span class="p">,</span> <span class="mf">0.1719380617102505</span><span class="p">,</span>
                   <span class="mf">0.173537727285836</span><span class="p">,</span> <span class="mf">0.17268164846620168</span><span class="p">,</span>
                   <span class="mf">0.17202374731742412</span><span class="p">,</span> <span class="mf">0.17073150361330935</span><span class="p">,</span>
                   <span class="mf">0.1704552789189035</span><span class="p">,</span> <span class="mf">0.17349453196470094</span><span class="p">,</span>
                   <span class="mf">0.17750026098212954</span><span class="p">,</span> <span class="mf">0.17998882407680658</span><span class="p">,</span>
                   <span class="mf">0.18054660903180453</span><span class="p">,</span> <span class="mf">0.17991221467411075</span><span class="p">,</span>
                   <span class="mf">0.17879081786543402</span><span class="p">,</span> <span class="mf">0.17698044738876634</span><span class="p">,</span>
                   <span class="mf">0.17481216302184016</span><span class="p">,</span> <span class="mf">0.1751095588835362</span><span class="p">,</span>
                   <span class="mf">0.17730235300005773</span><span class="p">,</span> <span class="mf">0.17828917633948513</span><span class="p">,</span>
                   <span class="mf">0.17798693352549597</span><span class="p">,</span> <span class="mf">0.1772903761042442</span><span class="p">,</span>
                   <span class="mf">0.17719593452088098</span><span class="p">,</span> <span class="mf">0.1767203402146187</span><span class="p">,</span>
                   <span class="mf">0.17450815886422721</span><span class="p">,</span> <span class="mf">0.17625358243592468</span><span class="p">,</span>
                   <span class="mf">0.17887701620267582</span><span class="p">,</span> <span class="mf">0.1808136330474918</span><span class="p">,</span>
                   <span class="mf">0.1813785961957623</span><span class="p">,</span> <span class="mf">0.18172509147369986</span><span class="p">,</span>
                   <span class="mf">0.18184876453017618</span><span class="p">,</span> <span class="mf">0.18271725245843057</span><span class="p">,</span>
                   <span class="mf">0.18252036797692608</span><span class="p">,</span> <span class="mf">0.183265249795722</span><span class="p">,</span>
                   <span class="mf">0.1844909214607128</span><span class="p">,</span> <span class="mf">0.18434110595951833</span><span class="p">,</span>
                   <span class="mf">0.1836490864781075</span><span class="p">,</span> <span class="mf">0.1819315626374836</span><span class="p">,</span>
                   <span class="mf">0.18101720818481568</span><span class="p">,</span> <span class="mf">0.17955118573504456</span><span class="p">,</span>
                   <span class="mf">0.17735986473912252</span><span class="p">,</span> <span class="mf">0.17627436278489908</span><span class="p">,</span>
                   <span class="mf">0.17619709057120855</span><span class="p">,</span> <span class="mf">0.17565989305918675</span><span class="p">,</span>
                   <span class="mf">0.173237661796461</span><span class="p">,</span> <span class="mf">0.17174118540853084</span><span class="p">,</span>
                   <span class="mf">0.1715433743879658</span><span class="p">,</span> <span class="mf">0.17103179349744851</span><span class="p">,</span>
                   <span class="mf">0.17009143210388886</span><span class="p">,</span> <span class="mf">0.17036903993748823</span><span class="p">,</span>
                   <span class="mf">0.1701968332986933</span><span class="p">,</span> <span class="mf">0.16931755448903732</span><span class="p">,</span>
                   <span class="mf">0.16809969031904087</span><span class="p">,</span> <span class="mf">0.16694191454539364</span><span class="p">,</span>
                   <span class="mf">0.16614923082470998</span><span class="p">,</span> <span class="mf">0.16574702124976093</span><span class="p">,</span>
                   <span class="mf">0.16442009711927774</span><span class="p">,</span> <span class="mf">0.163817742262745</span><span class="p">,</span>
                   <span class="mf">0.16433976044469292</span><span class="p">,</span> <span class="mf">0.16499539122759532</span><span class="p">,</span>
                   <span class="mf">0.16405480998741243</span><span class="p">,</span> <span class="mf">0.1628713751723746</span><span class="p">,</span>
                   <span class="mf">0.16180210801804973</span><span class="p">,</span> <span class="mf">0.16132300069909628</span><span class="p">,</span>
                   <span class="mf">0.16076469208509833</span><span class="p">,</span> <span class="mf">0.1619812080249729</span><span class="p">,</span>
                   <span class="mf">0.16568802507402378</span><span class="p">,</span> <span class="mf">0.16834462196868816</span><span class="p">,</span>
                   <span class="mf">0.1688091207855011</span><span class="p">,</span> <span class="mf">0.16874451605557048</span><span class="p">,</span>
                   <span class="mf">0.16918274517630819</span><span class="p">,</span> <span class="mf">0.16976238755144346</span><span class="p">,</span>
                   <span class="mf">0.16853813844367546</span><span class="p">,</span> <span class="mf">0.1689505218199379</span><span class="p">,</span>
                   <span class="mf">0.17008794466862398</span><span class="p">,</span> <span class="mf">0.1713995695153675</span><span class="p">,</span>
                   <span class="mf">0.17160758485378236</span><span class="p">,</span> <span class="mf">0.1719104396714293</span><span class="p">,</span>
                   <span class="mf">0.17141519454588505</span><span class="p">,</span> <span class="mf">0.17098573396603006</span><span class="p">,</span>
                   <span class="mf">0.17014341748677245</span><span class="p">,</span> <span class="mf">0.17124457916107655</span><span class="p">,</span>
                   <span class="mf">0.17343997831072036</span><span class="p">,</span> <span class="mf">0.17267167552123458</span><span class="p">,</span>
                   <span class="mf">0.17119276567171318</span><span class="p">,</span> <span class="mf">0.17110151528151052</span><span class="p">,</span>
                   <span class="mf">0.17129777088602452</span><span class="p">,</span> <span class="mf">0.1706512286992157</span><span class="p">,</span>
                   <span class="mf">0.1697909385002585</span><span class="p">,</span> <span class="mf">0.1701305419449026</span><span class="p">,</span>
                   <span class="mf">0.17177346958794434</span><span class="p">,</span> <span class="mf">0.17199251637814433</span><span class="p">,</span>
                   <span class="mf">0.1717777280458928</span><span class="p">,</span> <span class="mf">0.17140460031838234</span><span class="p">,</span>
                   <span class="mf">0.1708872614290405</span><span class="p">,</span> <span class="mf">0.16939067518025105</span><span class="p">,</span>
                   <span class="mf">0.16730749171621387</span><span class="p">,</span> <span class="mf">0.16687632033654826</span><span class="p">,</span>
                   <span class="mf">0.16768823626524956</span><span class="p">,</span> <span class="mf">0.16777431113498986</span><span class="p">,</span>
                   <span class="mf">0.16696977975746236</span><span class="p">,</span> <span class="mf">0.1663374313210154</span><span class="p">,</span>
                   <span class="mf">0.16650691596502723</span><span class="p">,</span> <span class="mf">0.16594519982156614</span><span class="p">,</span>
                   <span class="mf">0.1651931704892058</span><span class="p">,</span> <span class="mf">0.1651909843511451</span><span class="p">,</span>
                   <span class="mf">0.16565543871393762</span><span class="p">,</span> <span class="mf">0.1660138264006659</span><span class="p">,</span>
                   <span class="mf">0.16468225292020627</span><span class="p">,</span> <span class="mf">0.16419141107042712</span><span class="p">],</span>
             <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
       <span class="n">fill_value</span><span class="o">=</span><span class="mf">1e+20</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">weighted_mean</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">())</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f2d7825dda0</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_36_1.png" src="_images/tut00_get_started_36_1.png" />
<p>The following notebook introduces in more detail how pyaerocom handles
regions and where they can be defined. In the subsequent tutorial, the
<code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class is introduced, that was usesed above to import
model data in a flexible way based on variable name, time range and
temporal resolution. The loaded data for each model and variable is then
stored in the analysis class <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> which we use in the end of
this notebook and which will be introduced in a later tutorial.</p>
</div>
</div>
<div class="section" id="aerocom-default-regions">
<h2>AEROCOM default regions<a class="headerlink" href="#aerocom-default-regions" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces how pya handles information related to default
regions (e.g.&nbsp;Europe, Asia, …) as used in the <a class="reference external" href="http://aerocom.met.no/cgi-bin/AEROCOM/aerocom/surfobs_annualrs.pl">AEROCOM
interface</a>.
All default regions are defined in the file
<a class="reference external" href="http://aerocom.met.no/pya/config_files.html#default-regions">regions.ini</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">get_all_default_region_ids</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">29</span><span class="p">,</span><span class="mi">726</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">basemap</span> <span class="n">extension</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">installed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">imported</span><span class="o">.</span> <span class="n">Some</span> <span class="n">features</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">available</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="mi">513</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">geopy</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span><span class="o">.</span> <span class="n">Aeolus</span> <span class="n">data</span> <span class="n">read</span> <span class="ow">not</span> <span class="n">enabled</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;WORLD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUROPE&#39;</span><span class="p">,</span> <span class="s1">&#39;ASIA&#39;</span><span class="p">,</span> <span class="s1">&#39;AUSTRALIA&#39;</span><span class="p">,</span> <span class="s1">&#39;CHINA&#39;</span><span class="p">,</span> <span class="s1">&#39;INDIA&#39;</span><span class="p">,</span> <span class="s1">&#39;NAFRICA&#39;</span><span class="p">,</span> <span class="s1">&#39;SAFRICA&#39;</span><span class="p">,</span> <span class="s1">&#39;SAMERICA&#39;</span><span class="p">,</span> <span class="s1">&#39;NAMERICA&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now load some default regions and print them.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">europe</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">)</span>
<span class="n">asia</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="s2">&quot;ASIA&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">europe</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">asia</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaeorocom</span> <span class="n">Region</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">EUROPE</span>
<span class="n">Longitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
<span class="n">Longitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>

<span class="n">pyaeorocom</span> <span class="n">Region</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">ASIA</span>
<span class="n">Longitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
<span class="n">Longitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="load-example-data-and-apply-region-specific-crop">
<h3>Load example data and apply region specific crop<a class="headerlink" href="#load-example-data-and-apply-region-specific-crop" title="Permalink to this headline">¶</a></h3>
<p>In the following cell, we create an instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code>
class (hich is introduced in more detail in a later tutorial), load some
test data (from the CAMS ECMWF OSUITE dataset), crop it and plot a map
of the results over Europe.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">_init_testdata_default</span><span class="p">()</span>
<span class="n">crop</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">crop</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="mi">727</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">File</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span> <span class="n">contains</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">data</span> <span class="n">field</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Organic</span> <span class="n">Matter</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Black</span> <span class="n">Carbon</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">Sulphate</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut01_intro_regions_5_1.png" src="_images/tut01_intro_regions_5_1.png" />
</div>
</div>
<div class="section" id="reading-model-data-the-readgridded-class">
<h2>Reading model data: the <em>ReadGridded</em> class<a class="headerlink" href="#reading-model-data-the-readgridded-class" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces the
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.io.readgridded.ReadGridded">ReadGridded</a>
class of pyaerocom, a flexible interface for importing model results
from a single model, based on variable name (e.g. <em>od550aer</em>,
<em>od550bc</em>), start / stop time stamps and temporal resolution (e.g.
<em>hourly, 3hourly, daily, monthly</em>).</p>
<p>The class is part of the
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.io.readgridded">readgridded</a>
module of pyaerocom, as well as the class
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.io.readgridded.ReadGriddedMulti">ReadGriddedMulti</a>.</p>
<p>In the following cells, we create an instance of the the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code>
class and use this object to find and import data files containing the
aerosol optical depth at 550 nm (<em>od550aer</em>) from the ECMWF CAMS
reanalysis model (<em>ECMWF_CAMS_REAN</em>) for the years 2003-2007 in daily
resolution. The files will be temporally merged and put into an instance
of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class.</p>
<p>We start with creating a reading object, that will take care of finding
the model directory for us (based on the model ID) and all valid NetCDF
files on initialisation. Use the <code class="docutils literal notranslate"><span class="pre">print</span></code> commant to preview the string
representation of <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> object, which provides useful
information about what is in there.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>
<span class="n">read</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_CAMS_REAN&quot;</span><span class="p">,</span>
                          <span class="n">start</span><span class="o">=</span><span class="s2">&quot;1-1-2003&quot;</span><span class="p">,</span>
                          <span class="n">stop</span><span class="o">=</span><span class="s2">&quot;31-12-2007&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">34</span><span class="p">,</span><span class="mi">357</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">basemap</span> <span class="n">extension</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">installed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">imported</span><span class="o">.</span> <span class="n">Some</span> <span class="n">features</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">available</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span><span class="mi">233</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">geopy</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span><span class="o">.</span> <span class="n">Aeolus</span> <span class="n">data</span> <span class="n">read</span> <span class="ow">not</span> <span class="n">enabled</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span><span class="n">ECMWF_CAMS_REAN</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The output contains information about all variables that were found and
all corresponding years. These information is extracted from the
filenames, which have to follow the AEROCOM file naming conventions.</p>
<p><strong>Please note</strong> that at this point, no data is actually imported but
only the paths are set that contain data for this model. In order to
read one variable, call the <code class="docutils literal notranslate"><span class="pre">read_var</span></code> function with a valid variable
name. You can check available variables using the <code class="docutils literal notranslate"><span class="pre">vars</span></code> attribute (or
by printing the string representation, as shown in the cell above).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detected variables for model </span><span class="si">%s</span><span class="s2">:</span><span class="se">\n</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">read</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">read</span><span class="o">.</span><span class="n">vars</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Detected</span> <span class="n">variables</span> <span class="k">for</span> <span class="n">model</span> <span class="n">ECMWF_CAMS_REAN</span><span class="p">:</span>
 <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">read</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The returned data object is of type
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.griddeddata.GriddedData">GriddedData</a>
class, which will be introduced in more detail later. This data object
is returned by the <code class="docutils literal notranslate"><span class="pre">read_var</span></code> method and can also be accessed from the
instance of the reading class using:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">read</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;od550aer&quot;</span><span class="p">]</span>
<span class="n">d</span> <span class="ow">is</span> <span class="n">data</span> <span class="c1">#?</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<p>We may also import other variables using either the above used method
<code class="docutils literal notranslate"><span class="pre">read_var</span></code> or the more general <code class="docutils literal notranslate"><span class="pre">read</span></code> method which can read single
or multiple variables on the run.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="o">.</span><span class="n">read</span><span class="p">([</span><span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s double check if all variables have been imported.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span><span class="n">ECMWF_CAMS_REAN</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">GriddedData</span> <span class="n">objects</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550bc</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550oa</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550so4</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>
</pre></div>
</div>
<p>In the following we continue with the <code class="docutils literal notranslate"><span class="pre">od550aer</span></code> data object that was
loaded first and that was assigned the name <code class="docutils literal notranslate"><span class="pre">data</span></code> above.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The data object is of type </span><span class="si">%s</span><span class="s2"> and contains </span><span class="si">%d</span><span class="s2"> time stamps&quot;</span> <span class="o">%</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>The data object is of type &lt;class &#39;pyaerocom.griddeddata.GriddedData&#39;&gt; and contains 1826 time stamps
</pre></div>
</div>
<p>The returned
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.griddeddata.GriddedData">GriddedData</a>
object contains 1826 time stamps. Given that the defined period of 5
years includes one leap year, we should expect that we imported data for
each day of the five years?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">1826</span> <span class="o">==</span> <span class="mi">5</span><span class="o">*</span><span class="mi">365</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="section" id="remark-on-time-definition">
<h3>Remark on time definition<a class="headerlink" href="#remark-on-time-definition" title="Permalink to this headline">¶</a></h3>
<p>If you run this notebook with <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code> in the reading object,
you will receive the output</p>
<p><code class="docutils literal notranslate"><span class="pre">Error</span> <span class="pre">message:</span> <span class="pre">AttributeError('Cube</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">contain</span> <span class="pre">time</span> <span class="pre">dimension',)</span>&#160; <span class="pre">Invalid</span> <span class="pre">time</span> <span class="pre">axis</span> <span class="pre">in</span> <span class="pre">file</span> <span class="pre">ECMWF_CAMS_REAN.daily.od550aer.2007.nc.</span> <span class="pre">Attempting</span> <span class="pre">to</span> <span class="pre">correct.</span></code></p>
<p>several times when reading the data. This warning indicates, that the
corresponding data in the netCDF files has some issue with the time
dimension. Here, the time variable is not properly defined in the NetCDF
file. Pyaerocom can correct for this on data import by</p>
<ol class="arabic simple">
<li>First checking if the time dimension in the NetCDF file is correct
according to CF convention (<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.io.helpers.check_time_coord">see here for details on the
implementation</a>
and if a problem is detected, then …</li>
<li>the time axis is redefined based on the year and time resolution
(<em>ts_type</em>) that is encrypted in the filename. The latter requires
that the file follows one of the <a class="reference external" href="http://aerocom.met.no/pyaerocom/config_files.html#file-conventions">pyaerocom file
conventions</a>.</li>
</ol>
</div>
<div class="section" id="a-very-brief-introduction-into-the-griddeddata-class">
<h3>A very brief introduction into the GriddedData class<a class="headerlink" href="#a-very-brief-introduction-into-the-griddeddata-class" title="Permalink to this headline">¶</a></h3>
<p>Now as a final step, we briefly introduce some of the features of the
<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class by computing and plotting a time series of the
global weighted average aerosol optical density as well as the same time
series at the coordinates in the city of Leipzig, Germany.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">gaussian_filter1d</span>
<span class="c1">#compute global mean (area weighted)</span>
<span class="n">glob_mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">area_weighted_mean</span><span class="p">()</span>

<span class="c1">#extract AODs at the position of Leipzig</span>
<span class="n">lon_leipzig</span> <span class="o">=</span> <span class="mf">12.44</span>
<span class="n">lat_leipzig</span> <span class="o">=</span> <span class="mf">51.35</span>

<span class="n">data_leipzig</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">([(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">lat_leipzig</span><span class="p">),</span>
                                 <span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="n">lon_leipzig</span><span class="p">)])</span>

<span class="c1"># create pandas Series for global average</span>
<span class="n">s_glob</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">glob_mean</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">())</span>

<span class="c1"># create pandas Series for leipzig average (and smooth in time)</span>
<span class="n">GAUSS_SIGMA</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">s_leipzig</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">data_leipzig</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">GAUSS_SIGMA</span><span class="p">),</span>
                   <span class="n">data_leipzig</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">())</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">s_leipzig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;City of Leipzig (smoothed $\sigma$=</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="k">GAUSS_SIGMA</span>, figsize=(14,5))
<span class="n">s_glob</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Global trend&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">tit</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;AOD @ 550nm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">analysis</span><span class="o">/</span><span class="n">cartography</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">377</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Using</span> <span class="n">DEFAULT_SPHERICAL_EARTH_RADIUS</span><span class="o">.</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Using DEFAULT_SPHERICAL_EARTH_RADIUS.&quot;</span><span class="p">)</span>
<span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">1826</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<img alt="_images/tut02_intro_class_ReadGridded_17_1.png" src="_images/tut02_intro_class_ReadGridded_17_1.png" />
<p>In the following section, the <code class="docutils literal notranslate"><span class="pre">ReadGriddedMulti</span></code> class is introduced,
which is largely based on the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class and allows for
importing data from multiple models.</p>
</div>
</div>
<div class="section" id="reading-data-from-multiple-models-the-readgriddedmulti-class">
<h2>Reading data from multiple models: the ReadGriddedMulti class<a class="headerlink" href="#reading-data-from-multiple-models-the-readgriddedmulti-class" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">pyaerocom.ReadGriddedMulti</span></code> class provides an interface to import
multiple variables for an arbitrary number of gridded datasets
(e.g.&nbsp;model data, level 2 satellite data) and within a specific time
interval. It makes large use of the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class that provides
an interface for importing results from a single dataset.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span><span class="mi">897</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">basemap</span> <span class="n">extension</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">installed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">imported</span><span class="o">.</span> <span class="n">Some</span> <span class="n">features</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">available</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">58</span><span class="p">,</span><span class="mi">437</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">geopy</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span><span class="o">.</span> <span class="n">Aeolus</span> <span class="n">data</span> <span class="n">read</span> <span class="ow">not</span> <span class="n">enabled</span>
</pre></div>
</div>
<p>Define two models (this list can contain as many models as you like)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AATSR_SU_v4.3&quot;</span><span class="p">,</span> <span class="s2">&quot;CAM5.3-Oslo_CTRL2016&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Again, if you are not sure what is the exact name of the dataset you are
searching for, you may use wildcards to search for options. For
instance, if you want to include results from the implementation of the
sectional aerosol microphysics module (SALSA) in the ECHAM5-HAM
aerosol-climate model, you may search if data exists …</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">pya</span><span class="o">.</span><span class="n">search_data_dir_aerocom</span><span class="p">(</span><span class="s2">&quot;*ECHAM*salsa*CTRL*2015&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
<p>… and include it:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;ECHAM6-SALSA_AP3-CTRL2015&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now create and initiate <code class="docutils literal notranslate"><span class="pre">ReadGriddedMulti</span></code> class. The directory for
each model as well as all valid files in the model directories are
searched on initiation of the instance. Valid here means, that the files
belong to the corresponding model. Subsetting of the time interval is
done in a later process.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">read</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGriddedMulti</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span><span class="s1">&#39;2011&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGriddedMulti</span>
<span class="o">--------------------------</span>
<span class="n">Model</span> <span class="n">IDs</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AATSR_SU_v4.3&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5.3-Oslo_CTRL2016&#39;</span><span class="p">,</span> <span class="s1">&#39;ECHAM6-SALSA_AP3-CTRL2015&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">data</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">CCI</span><span class="o">-</span><span class="n">Aerosol</span><span class="o">/</span><span class="n">CCI_AEROSOL_Phase2</span><span class="o">/</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550erraer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550gt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">]</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;deltaz3d&#39;</span><span class="p">,</span> <span class="s1">&#39;humidity3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;3hourly&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">]</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;depbc&#39;</span><span class="p">,</span> <span class="s1">&#39;depdust&#39;</span><span class="p">,</span> <span class="s1">&#39;depoa&#39;</span><span class="p">,</span> <span class="s1">&#39;depso4&#39;</span><span class="p">,</span> <span class="s1">&#39;depss&#39;</span><span class="p">,</span> <span class="s1">&#39;emibc&#39;</span><span class="p">,</span> <span class="s1">&#39;emidms&#39;</span><span class="p">,</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span> <span class="s1">&#39;emiss&#39;</span><span class="p">,</span> <span class="s1">&#39;emivoc&#39;</span><span class="p">,</span> <span class="s1">&#39;emivoct&#39;</span><span class="p">,</span> <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span> <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span> <span class="s1">&#39;loadss&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>As you can see, the 3 different instances of the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class
were created (which was introduced in the previous tutorial), one for
each of the 3 requested datasets. These can be used to access the data
for each of the datasets.</p>
<p>Let’s define a bunch of test variables that are supposed to be loaded
for each model.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="s2">&quot;od550dust&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Read all variables for all models</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_dict</span> <span class="o">=</span> <span class="n">read</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">test_vars</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>As we can see, for the ECHAM6 data, the import failed. The reason for
this is, that these data only exists in monthly resolution. We can load
this data manually.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">read</span><span class="p">[</span><span class="s2">&quot;ECHAM6-SALSA_AP3-CTRL2015&quot;</span><span class="p">]</span>
<span class="n">r</span><span class="o">.</span><span class="n">vars</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;depbc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depdust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depoa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depso4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emibc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emidms&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emidust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emiss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emivoc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emivoct&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loadss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcss&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now read the aerosol optical depth at 550 nm and in monthly resolution.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s2">&quot;monthly&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_ambient_aerosol_particles</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">96</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Print what is in there (similar to the previously introduced
<code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class, also the <code class="docutils literal notranslate"><span class="pre">ReadGriddedMulti</span></code> class has a helpful
string representation)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGriddedMulti</span>
<span class="o">--------------------------</span>
<span class="n">Model</span> <span class="n">IDs</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AATSR_SU_v4.3&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5.3-Oslo_CTRL2016&#39;</span><span class="p">,</span> <span class="s1">&#39;ECHAM6-SALSA_AP3-CTRL2015&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">data</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">CCI</span><span class="o">-</span><span class="n">Aerosol</span><span class="o">/</span><span class="n">CCI_AEROSOL_Phase2</span><span class="o">/</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550erraer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550gt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">GriddedData</span> <span class="n">objects</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;deltaz3d&#39;</span><span class="p">,</span> <span class="s1">&#39;humidity3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;3hourly&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">GriddedData</span> <span class="n">objects</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;depbc&#39;</span><span class="p">,</span> <span class="s1">&#39;depdust&#39;</span><span class="p">,</span> <span class="s1">&#39;depoa&#39;</span><span class="p">,</span> <span class="s1">&#39;depso4&#39;</span><span class="p">,</span> <span class="s1">&#39;depss&#39;</span><span class="p">,</span> <span class="s1">&#39;emibc&#39;</span><span class="p">,</span> <span class="s1">&#39;emidms&#39;</span><span class="p">,</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span> <span class="s1">&#39;emiss&#39;</span><span class="p">,</span> <span class="s1">&#39;emivoc&#39;</span><span class="p">,</span> <span class="s1">&#39;emivoct&#39;</span><span class="p">,</span> <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span> <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span> <span class="s1">&#39;loadss&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">GriddedData</span> <span class="n">objects</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">monthly</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">monthly</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>
</pre></div>
</div>
<p>Print some information about the different data objects</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">read</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current model: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">name</span>)
    <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Current variable: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">var_name</span>)
        <span class="c1"># data is of type pya.GriddedData which uses an extended representation of the Cube class</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Current</span> <span class="n">model</span><span class="p">:</span> <span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_ambient_aerosol</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">366</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">180</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">360</span><span class="p">)</span><span class="o">&gt;</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_ambient_aerosol</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">366</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">180</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">360</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">Current</span> <span class="n">model</span><span class="p">:</span> <span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">288</span><span class="p">)</span><span class="o">&gt;</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">mineral</span> <span class="n">aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">288</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">Current</span> <span class="n">model</span><span class="p">:</span> <span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_ambient_aerosol_particles</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">96</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">)</span><span class="o">&gt;</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_dust_ambient_aerosol_particles</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">96</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Now get and arbitrarily crop the CAM5.3-Oslo_CTRL2016 data object
containing the od550aer values and draw a map.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">read</span><span class="p">[</span><span class="s2">&quot;CAM5.3-Oslo_CTRL2016&quot;</span><span class="p">][</span><span class="s2">&quot;od550aer&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Start / stop before crop: </span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
        <span class="n">data</span><span class="o">.</span><span class="n">stop</span><span class="p">))</span>

<span class="n">dat_crop</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">lon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
                     <span class="n">lat_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
                     <span class="n">time_range</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;15 March 2010&#39;</span><span class="p">,</span><span class="s1">&#39;22 June 2010&#39;</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start / stop after crop: </span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2">&quot;</span>
      <span class="o">%</span><span class="p">(</span><span class="n">dat_crop</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
        <span class="n">dat_crop</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">point</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Start</span> <span class="o">/</span> <span class="n">stop</span> <span class="n">before</span> <span class="n">crop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>

<span class="n">Start</span> <span class="o">/</span> <span class="n">stop</span> <span class="n">after</span> <span class="n">crop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">15</span> <span class="mi">10</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">22</span> <span class="mi">10</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>
</pre></div>
</div>
<p>Plot a map of the first day.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">dat_crop</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/tut03_intro_class_ReadGriddedMulti_25_0.png" src="_images/tut03_intro_class_ReadGriddedMulti_25_0.png" />
<div class="section" id="iterate-over-models-and-variables">
<h3>Iterate over models and variables<a class="headerlink" href="#iterate-over-models-and-variables" title="Permalink to this headline">¶</a></h3>
<p>The following cell iterates over all imported variables and models and
plots the first time stamp of each result file.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">read</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">model_data</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">model_data</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_0.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_0.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_1.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_1.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_2.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_2.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_3.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_3.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_4.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_4.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_5.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_5.png" />
</div>
</div>
<div class="section" id="introducing-the-griddeddata-class">
<h2>Introducing the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class<a class="headerlink" href="#introducing-the-griddeddata-class" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces basic features of the
<a class="reference external" href="http://aerocom.met.no/pya/api.html#pya.griddeddata.GriddedData">GriddedData</a>
class of pya. The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is the fundamental base class
for the analysis of model data. The underlying data type is
<a class="reference external" href="http://scitools.org.uk/iris/docs/latest/iris/iris/cube.html#iris.cube.Cube">iris.cube.Cube</a>
which was extended, for instance by allowing direct imports of netCDF
files when creating an instance of <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> (i.e.&nbsp;by passing the
filename and specifying the variable name on initialisation). This
notebook introduces some of the features of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class.
Starting with some imports…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">421</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">basemap</span> <span class="n">extension</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">installed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">imported</span><span class="o">.</span> <span class="n">Some</span> <span class="n">features</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">available</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">08</span><span class="p">,</span><span class="mi">267</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">geopy</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span><span class="o">.</span> <span class="n">Aeolus</span> <span class="n">data</span> <span class="n">read</span> <span class="ow">not</span> <span class="n">enabled</span>
</pre></div>
</div>
<p>Let’s get a test file to load</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_files</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">testfiles</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">filepath</span> <span class="ow">in</span> <span class="n">test_files</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">filepath</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aatsr_su_v4</span><span class="o">.</span><span class="mi">3</span>
<span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">CCI</span><span class="o">-</span><span class="n">Aerosol</span><span class="o">/</span><span class="n">CCI_AEROSOL_Phase2</span><span class="o">/</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mf">3.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2008.</span><span class="n">nc</span>

<span class="n">ecmwf_osuite</span>
<span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span>
</pre></div>
</div>
<p>The dictionary, returned by the <code class="docutils literal notranslate"><span class="pre">get()</span></code> function is categorised into
two subirectories for model based test files (<code class="docutils literal notranslate"><span class="pre">key=&quot;models&quot;</span></code>) and for
observation based test files (<code class="docutils literal notranslate"><span class="pre">key=observations</span></code>). So far, there is
not much in there (i.e.&nbsp;only two files).</p>
<p>Let’s pick out the ECMWF OSUITE test file and load the data directly
into an instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class. The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class
takes either preloaded instances of the <code class="docutils literal notranslate"><span class="pre">iris.cube.Cube</span></code> class as
input, or a valid netCDF file path. The latter requires specification of
the variable name which is then filtered from the data stored in the
netCDF file (which may contain multiple variables. The following example
imports the data for the aerosol optical density at 550 nm. The string
representation of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class (see print at end of
following code cell) was slitghtly adapted from the underlying <code class="docutils literal notranslate"><span class="pre">Cube</span></code>
object.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fpath</span> <span class="o">=</span> <span class="n">test_files</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">][</span><span class="s2">&quot;ecmwf_osuite&quot;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">08</span><span class="p">,</span><span class="mi">398</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">File</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span> <span class="n">contains</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">data</span> <span class="n">field</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Black</span> <span class="n">Carbon</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">Organic</span> <span class="n">Matter</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">Sulphate</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">:</span> <span class="n">ECMWF_OSUITE</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
     <span class="n">Dimension</span> <span class="n">coordinates</span><span class="p">:</span>
          <span class="n">time</span>                                       <span class="n">x</span>              <span class="o">-</span>               <span class="o">-</span>
          <span class="n">latitude</span>                                   <span class="o">-</span>              <span class="n">x</span>               <span class="o">-</span>
          <span class="n">longitude</span>                                  <span class="o">-</span>              <span class="o">-</span>               <span class="n">x</span>
     <span class="n">Attributes</span><span class="p">:</span>
          <span class="n">Conventions</span><span class="p">:</span> <span class="n">CF</span><span class="o">-</span><span class="mf">1.0</span>
          <span class="n">NCO</span><span class="p">:</span> <span class="mf">4.7</span><span class="o">.</span><span class="mi">2</span>
          <span class="n">history</span><span class="p">:</span> <span class="n">Tue</span> <span class="n">Mar</span> <span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">49</span> <span class="mi">2018</span><span class="p">:</span> <span class="n">ncks</span> <span class="o">-</span><span class="mi">7</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">o</span> <span class="n">test</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">v</span> <span class="n">time_bnds</span> <span class="n">od550aer</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">orig</span><span class="o">.</span><span class="n">nc</span>
<span class="n">Tue</span><span class="o">...</span>
          <span class="n">history_of_appended_files</span><span class="p">:</span> <span class="n">Tue</span> <span class="n">Mar</span> <span class="mi">20</span> <span class="mi">02</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">15</span> <span class="mi">2018</span><span class="p">:</span> <span class="n">Appended</span> <span class="n">file</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT</span><span class="o">/</span><span class="n">renamed</span><span class="o">//</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550bc</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span><span class="o">...</span>
          <span class="n">invalid_units</span><span class="p">:</span> <span class="o">~</span>
          <span class="n">nco_openmp_thread_number</span><span class="p">:</span> <span class="mi">1</span>
     <span class="n">Cell</span> <span class="n">methods</span><span class="p">:</span>
          <span class="n">mean</span><span class="p">:</span> <span class="n">time</span>
</pre></div>
</div>
<div class="section" id="remark-on-longitude-definition">
<h3>Remark on longitude definition<a class="headerlink" href="#remark-on-longitude-definition" title="Permalink to this headline">¶</a></h3>
<div class="alert alert-block alert-info"><p>If the longitudes in the original NetCDF file are defined as</p>
<div class="math notranslate nohighlight">
\[0 \leq\,\text{lon}\,\leq360\]</div>
<p>they are converted automatically to</p>
<div class="math notranslate nohighlight">
\[-180\leq\,\text{lon}\,\leq180\]</div>
<p>when an instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is created (see print
statment above <em>Rolling longitudes to -180 -&gt; 180 definition</em>). This is,
for instance, the case for the ECMWF OSUITE data files.</p>
</div></div>
<div class="section" id="features-of-the-griddeddata-class">
<h3>Features of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class<a class="headerlink" href="#features-of-the-griddeddata-class" title="Permalink to this headline">¶</a></h3>
<p>In the following cell, some of the most important attributes are
introduced. These are mostly reimplementations of the underlying
<code class="docutils literal notranslate"><span class="pre">Cube</span></code> data which is stored in the <code class="docutils literal notranslate"><span class="pre">GriddedData.grid</span></code> attribute. For
instance the attribute <code class="docutils literal notranslate"><span class="pre">GriddedData.longitude</span></code> get’s you
<code class="docutils literal notranslate"><span class="pre">GriddedData.grid.coord(&quot;longitude&quot;)</span></code>, <code class="docutils literal notranslate"><span class="pre">GriddedData.latitude</span></code> get’s
you <code class="docutils literal notranslate"><span class="pre">GriddedData.grid.coord(&quot;latitude&quot;)</span></code> and <code class="docutils literal notranslate"><span class="pre">GriddedData.time</span></code>
get’s you <code class="docutils literal notranslate"><span class="pre">GriddedData.grid.coord(&quot;time&quot;)</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">var_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Longitude attr is pointer to DimCoord instance of underlying Cube: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span> <span class="ow">is</span> <span class="n">data</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">tstamps</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tstamps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tstamps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>od550aer
&lt;class &#39;iris.coords.DimCoord&#39;&gt;
Longitude attr is pointer to DimCoord instance of underlying Cube: True
-180.0 179.60000610351562
-90.0 90.0
0.0 364.0
2018-01-01T00:00:00.000000 2018-12-31T00:00:00.000000
</pre></div>
</div>
<p>If you do not specify the variable type, an Exception is raised, that
will get you some information about what variables are available in the
file (if the file is readable using the <code class="docutils literal notranslate"><span class="pre">iris.load</span></code> method).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">fpath</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pya</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">NetcdfError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This did not work...error message: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">repr</span>(e))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">08</span><span class="p">,</span><span class="mi">525</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">File</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span> <span class="n">contains</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">data</span> <span class="n">field</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Black</span> <span class="n">Carbon</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">Organic</span> <span class="n">Matter</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">Sulphate</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">work</span><span class="o">...</span><span class="n">error</span> <span class="n">message</span><span class="p">:</span> <span class="n">NetcdfError</span><span class="p">(</span><span class="s2">&quot;Could not load single cube from /lustre/storeA/project/aerocom/aerocom1/ECMWF_OSUITE_NRT_test/renamed/aerocom.ECMWF_OSUITE_NRT_test.daily.od550aer.2018.nc. Please specify var_name. Input file contains the following variables: [&#39;od550aer&#39;, &#39;od550bc&#39;, &#39;od550dust&#39;, &#39;od550oa&#39;, &#39;od550so4&#39;]&quot;</span><span class="p">,)</span>
</pre></div>
</div>
<p>Also, if you parse an invalid variable name, you will get some hint.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Blaaa&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This also did not work...error message: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">repr</span>(e))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">08</span><span class="p">,</span><span class="mi">592</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">File</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span> <span class="n">contains</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">data</span> <span class="n">field</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Black</span> <span class="n">Carbon</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">Organic</span> <span class="n">Matter</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">Sulphate</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">also</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">work</span><span class="o">...</span><span class="n">error</span> <span class="n">message</span><span class="p">:</span> <span class="n">NetcdfError</span><span class="p">(</span><span class="s1">&#39;Variable Blaaa not available in file /lustre/storeA/project/aerocom/aerocom1/ECMWF_OSUITE_NRT_test/renamed/aerocom.ECMWF_OSUITE_NRT_test.daily.od550aer.2018.nc&#39;</span><span class="p">,)</span>
</pre></div>
</div>
<p>You can have a quick look at the data using the class-own quickplot
method</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">time_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">fix_aspect</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">c_over</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut04_intro_class_GriddedData_14_0.png" src="_images/tut04_intro_class_GriddedData_14_0.png" />
<p>Why not load some of the other variables…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bc</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550bc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
<span class="n">data_so4</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550so4&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">877</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">File</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span> <span class="n">contains</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">data</span> <span class="n">field</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Black</span> <span class="n">Carbon</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">Organic</span> <span class="n">Matter</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">Sulphate</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">946</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">File</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span> <span class="n">contains</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">data</span> <span class="n">field</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Black</span> <span class="n">Carbon</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">Organic</span> <span class="n">Matter</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">Sulphate</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
</pre></div>
</div>
<p>… and plot them as well</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span> <span class="o">=</span> <span class="n">data_bc</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">data_so4</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">lon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
                     <span class="n">lat_range</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">fix_aspect</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                                                       <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
                                                       <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">70</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/tut04_intro_class_GriddedData_18_0.png" src="_images/tut04_intro_class_GriddedData_18_0.png" />
<img alt="_images/tut04_intro_class_GriddedData_18_1.png" src="_images/tut04_intro_class_GriddedData_18_1.png" />
</div>
<div class="section" id="more-to-come">
<h3>… more to come<a class="headerlink" href="#more-to-come" title="Permalink to this headline">¶</a></h3>
<p>This tutorial is not yet completed as the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is
currently under development.</p>
</div>
</div>
<div class="section" id="colocating-gridded-data-with-discrete-observations">
<h2>Colocating gridded data with discrete observations<a class="headerlink" href="#colocating-gridded-data-with-discrete-observations" title="Permalink to this headline">¶</a></h2>
<p>This notebook gives an introduction into collocation of gridded data
with observations. Here, the 550 nm AODs of the ECMWF CAMS reanalysis
model are compared with global daily AeroNet Sun V2 (Level 2) data for
the year 2010. The collocated data will be analysed and visualised in
monthly resolution. The analysis results will be plotted in the form of
the well known Aerocom loglog scatter plots as can be found in the
online interface (see e.g.
<a class="reference external" href="http://aerocom.met.no/cgi-bin/aerocom/surfobs_annualrs.pl">here</a>).</p>
<div class="section" id="note">
<h3>NOTE<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>This notebook is currently under development</div></blockquote>
</div>
<div class="section" id="import-setup-and-imports">
<h3>Import setup and imports<a class="headerlink" href="#import-setup-and-imports" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>

<span class="n">YEAR</span> <span class="o">=</span> <span class="mi">2010</span>
<span class="n">VAR</span> <span class="o">=</span> <span class="s2">&quot;od550aer&quot;</span>
<span class="n">TS_TYPE</span> <span class="o">=</span> <span class="s2">&quot;daily&quot;</span>
<span class="n">MODEL_ID</span> <span class="o">=</span> <span class="s2">&quot;ECMWF_CAMS_REAN&quot;</span>
<span class="n">OBS_ID</span> <span class="o">=</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">24</span><span class="p">,</span><span class="mi">565</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">basemap</span> <span class="n">extension</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">installed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">imported</span><span class="o">.</span> <span class="n">Some</span> <span class="n">features</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">available</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">416</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">geopy</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span><span class="o">.</span> <span class="n">Aeolus</span> <span class="n">data</span> <span class="n">read</span> <span class="ow">not</span> <span class="n">enabled</span>
</pre></div>
</div>
</div>
<div class="section" id="import-of-model-data">
<h3>Import of model data<a class="headerlink" href="#import-of-model-data" title="Permalink to this headline">¶</a></h3>
<p>Create reader instance for model data and print overview of what is in
there.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">MODEL_ID</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_reader</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span><span class="n">ECMWF_CAMS_REAN</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Since we are only interested in a single year we can use the method</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_data</span> <span class="o">=</span> <span class="n">model_reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="n">VAR</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">YEAR</span><span class="p">)</span>
<span class="c1">#model_data = read_result[VAR][YEAR]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span>
     <span class="n">Dimension</span> <span class="n">coordinates</span><span class="p">:</span>
          <span class="n">time</span>                             <span class="n">x</span>              <span class="o">-</span>               <span class="o">-</span>
          <span class="n">latitude</span>                         <span class="o">-</span>              <span class="n">x</span>               <span class="o">-</span>
          <span class="n">longitude</span>                        <span class="o">-</span>              <span class="o">-</span>               <span class="n">x</span>
     <span class="n">Attributes</span><span class="p">:</span>
          <span class="n">Conventions</span><span class="p">:</span> <span class="n">CF</span><span class="o">-</span><span class="mf">1.6</span>
          <span class="n">NCO</span><span class="p">:</span> <span class="s2">&quot;4.5.4&quot;</span>
          <span class="n">history</span><span class="p">:</span> <span class="n">Sat</span> <span class="n">May</span> <span class="mi">26</span> <span class="mi">21</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">48</span> <span class="mi">2018</span><span class="p">:</span> <span class="n">ncecat</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">u</span> <span class="n">time</span> <span class="o">-</span><span class="n">n</span> <span class="mi">365</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span> <span class="n">CAMS_REAN_001</span><span class="o">.</span><span class="n">nc</span><span class="o">...</span>
          <span class="n">nco_openmp_thread_number</span><span class="p">:</span> <span class="mi">1</span>
     <span class="n">Cell</span> <span class="n">methods</span><span class="p">:</span>
          <span class="n">mean</span><span class="p">:</span> <span class="n">step</span>
          <span class="n">mean</span><span class="p">:</span> <span class="n">time</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">model_data</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">time_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut06_colocation_7_0.png" src="_images/tut06_colocation_7_0.png" />
</div>
<div class="section" id="import-of-aeronet-sun-v3-data-level-2">
<h3>Import of AeroNet Sun V3 data (Level 2)<a class="headerlink" href="#import-of-aeronet-sun-v3-data-level-2" title="Permalink to this headline">¶</a></h3>
<p>Import Aeronet data and apply filter that selects only stations that are
located at altitudes between 0 and 1000 m.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="p">(</span><span class="n">OBS_ID</span><span class="p">,</span> <span class="n">vars_to_retrieve</span><span class="o">=</span><span class="n">VAR</span><span class="p">)</span>
<span class="n">obs_data</span> <span class="o">=</span> <span class="n">obs_reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">filter_by_meta</span><span class="p">(</span><span class="n">stat_alt</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">UngriddedData</span>
<span class="o">-----------------------</span>
<span class="n">Contains</span> <span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">]</span>
<span class="n">Total</span> <span class="n">no</span><span class="o">.</span> <span class="n">of</span> <span class="n">stations</span><span class="p">:</span> <span class="mi">985</span>
<span class="n">Filters</span> <span class="n">that</span> <span class="n">were</span> <span class="n">applied</span><span class="p">:</span>
 <span class="n">Filter</span> <span class="n">time</span> <span class="n">log</span><span class="p">:</span> <span class="mi">20180928182930</span>
    <span class="n">stat_alt</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="now-perform-collocation-and-plot-corresponding-scatter-plots-with-statistical-values">
<h3>Now perform collocation and plot corresponding scatter plots with statistical values<a class="headerlink" href="#now-perform-collocation-and-plot-corresponding-scatter-plots-with-statistical-values" title="Permalink to this headline">¶</a></h3>
<div class="section" id="monthly-world-no-mountains">
<h4>2010 monthly World no mountains<a class="headerlink" href="#monthly-world-no-mountains" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded_2D</span><span class="p">(</span><span class="n">model_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                          <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="n">data_coloc</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;od550aer&#39;</span> <span class="p">(</span><span class="n">data_source</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="mi">278</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span>     <span class="n">nan</span><span class="p">,</span> <span class="mf">0.117588</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span> <span class="mf">0.132128</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mf">0.132236</span><span class="p">,</span> <span class="mf">0.195057</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span> <span class="mf">0.098409</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mf">0.189948</span><span class="p">,</span> <span class="mf">0.140062</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.079353</span><span class="p">,</span> <span class="mf">0.204337</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.150408</span><span class="p">,</span> <span class="mf">0.190089</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.10622</span> <span class="p">,</span> <span class="mf">0.257806</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mf">0.159844</span><span class="p">,</span> <span class="mf">0.178564</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.054091</span><span class="p">,</span> <span class="mf">0.239393</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.147172</span><span class="p">,</span> <span class="mf">0.138039</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.077916</span><span class="p">,</span> <span class="mf">0.19986</span> <span class="p">]]])</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">data_source</span>   <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U22</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span>
    <span class="n">var_name</span>      <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U8</span> <span class="s1">&#39;od550aer&#39;</span> <span class="s1">&#39;od550aer&#39;</span>
  <span class="o">*</span> <span class="n">time</span>          <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">station_name</span>  <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U19</span> <span class="s1">&#39;ARM_Darwin&#39;</span> <span class="s1">&#39;ATHENS-NOA&#39;</span> <span class="s1">&#39;Agoufou&#39;</span> <span class="o">...</span>
    <span class="n">latitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">12.43</span> <span class="mf">37.97</span> <span class="mf">15.35</span> <span class="o">-</span><span class="mf">9.871</span> <span class="mf">42.02</span> <span class="o">...</span>
    <span class="n">longitude</span>     <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">130.9</span> <span class="mf">23.72</span> <span class="o">-</span><span class="mf">1.479</span> <span class="o">-</span><span class="mf">56.1</span> <span class="o">-</span><span class="mf">93.77</span> <span class="o">...</span>
    <span class="n">altitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">29.9</span> <span class="mf">130.0</span> <span class="mf">305.0</span> <span class="mf">277.0</span> <span class="mf">338.0</span> <span class="mf">49.0</span> <span class="o">...</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">data_source</span><span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">,</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span><span class="p">]</span>
    <span class="n">var_name</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
    <span class="n">ts_type</span><span class="p">:</span>      <span class="n">monthly</span>
    <span class="n">filter_name</span><span class="p">:</span>  <span class="n">WORLD</span><span class="o">-</span><span class="n">noMOUNTAINS</span>
    <span class="n">ts_type_src</span><span class="p">:</span>  <span class="n">daily</span>
    <span class="n">start_str</span><span class="p">:</span>    <span class="mi">20100101</span>
    <span class="n">stop_str</span><span class="p">:</span>     <span class="mi">20101231</span>
    <span class="n">unit</span><span class="p">:</span>         <span class="mi">1</span>
    <span class="n">data_level</span><span class="p">:</span>   <span class="n">colocated</span>
    <span class="n">region</span><span class="p">:</span>       <span class="n">WORLD</span>
    <span class="n">lon_range</span><span class="p">:</span>    <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">]</span>
    <span class="n">lat_range</span><span class="p">:</span>    <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
    <span class="n">alt_range</span><span class="p">:</span>    <span class="p">[</span><span class="o">-</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7fdbb0a9e160</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut06_colocation_13_1.png" src="_images/tut06_colocation_13_1.png" />
</div>
<div class="section" id="daily-europe-no-mountains">
<h4>2010 daily Europe no mountains<a class="headerlink" href="#daily-europe-no-mountains" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded_2D</span><span class="p">(</span><span class="n">model_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span>
                                                             <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;EUROPE-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="n">data_coloc</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;od550aer&#39;</span> <span class="p">(</span><span class="n">data_source</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="mi">89</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span><span class="mf">0.163447</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.078648</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mf">0.086522</span><span class="p">,</span> <span class="mf">0.015151</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.075447</span><span class="p">,</span> <span class="mf">0.03005</span> <span class="p">],</span>
        <span class="p">[</span><span class="mf">0.067198</span><span class="p">,</span> <span class="mf">0.043074</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.103671</span><span class="p">,</span> <span class="mf">0.042999</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mf">0.242585</span><span class="p">,</span> <span class="mf">0.186407</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.053797</span><span class="p">,</span> <span class="mf">0.011344</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.079498</span><span class="p">,</span> <span class="mf">0.122098</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.027066</span><span class="p">,</span> <span class="mf">0.019639</span><span class="p">]]])</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">data_source</span>   <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U22</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span>
    <span class="n">var_name</span>      <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U8</span> <span class="s1">&#39;od550aer&#39;</span> <span class="s1">&#39;od550aer&#39;</span>
  <span class="o">*</span> <span class="n">time</span>          <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">station_name</span>  <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U19</span> <span class="s1">&#39;ATHENS-NOA&#39;</span> <span class="s1">&#39;Andenes&#39;</span> <span class="s1">&#39;Arcachon&#39;</span> <span class="o">...</span>
    <span class="n">latitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">37.97</span> <span class="mf">69.28</span> <span class="mf">44.66</span> <span class="mf">45.76</span> <span class="mf">42.0</span> <span class="mf">43.93</span> <span class="o">...</span>
    <span class="n">longitude</span>     <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">23.72</span> <span class="mf">16.01</span> <span class="o">-</span><span class="mf">1.163</span> <span class="mf">3.111</span> <span class="o">-</span><span class="mf">4.603</span> <span class="o">...</span>
    <span class="n">altitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">130.0</span> <span class="mf">379.0</span> <span class="mf">11.0</span> <span class="mf">423.0</span> <span class="mf">873.0</span> <span class="mf">32.0</span> <span class="o">...</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">data_source</span><span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">,</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span><span class="p">]</span>
    <span class="n">var_name</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
    <span class="n">ts_type</span><span class="p">:</span>      <span class="n">daily</span>
    <span class="n">filter_name</span><span class="p">:</span>  <span class="n">EUROPE</span><span class="o">-</span><span class="n">noMOUNTAINS</span>
    <span class="n">ts_type_src</span><span class="p">:</span>  <span class="n">daily</span>
    <span class="n">start_str</span><span class="p">:</span>    <span class="mi">20100101</span>
    <span class="n">stop_str</span><span class="p">:</span>     <span class="mi">20101231</span>
    <span class="n">unit</span><span class="p">:</span>         <span class="mi">1</span>
    <span class="n">data_level</span><span class="p">:</span>   <span class="n">colocated</span>
    <span class="n">region</span><span class="p">:</span>       <span class="n">EUROPE</span>
    <span class="n">lon_range</span><span class="p">:</span>    <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
    <span class="n">lat_range</span><span class="p">:</span>    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
    <span class="n">alt_range</span><span class="p">:</span>    <span class="p">[</span><span class="o">-</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7fdbb0b13c50</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut06_colocation_16_1.png" src="_images/tut06_colocation_16_1.png" />
<div class="section" id="further-tutorials-in-depth">
<h5>Further tutorials (in-depth)<a class="headerlink" href="#further-tutorials-in-depth" title="Permalink to this headline">¶</a></h5>
</div>
</div>
</div>
</div>
<div class="section" id="handling-of-time-in-pyaerocom">
<h2>Handling of time in pyaerocom<a class="headerlink" href="#handling-of-time-in-pyaerocom" title="Permalink to this headline">¶</a></h2>
<p>The
<a class="reference external" href="http://aerocom.met.no/pya/api.html#module-pya.griddeddata">GriddedData</a>
class of <em>pyaerocom</em> was introduced in the previous tutorial.</p>
<p>Here, we illustrate how <em>pyaerocom</em> handles time. In particular, how
<em>pyaerocom</em> performs the conversion of CF conform numerical time stamps
with a defined unit (i.e.&nbsp;basedate and calendar, see e.g.
<a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.6/build/cf-conventions.html#time-coordinate">here</a>
for details) into datetime-like objects that can be interpreted by tools
such as <a class="reference external" href="https://pandas.pydata.org/">Pandas</a>.</p>
<p>The easiest way to work with time stamps in model data is, to simply
work on the internal numerical indices, avoiding the necessity to
convert them into actual datetime objects. However, sometimes (e.g.&nbsp;if
we want to extract and analyse a time-series of global average Aerosol
optical densities), we wish to use third party libraries such as Pandas,
which require the timestamps to be datetime-like objects.</p>
<p>This notebook illustrates how time is handled in the iris module,
particularly in the
<a class="reference external" href="http://scitools.org.uk/iris/docs/v1.9.0/html/iris/iris/cube.html#iris.cube.Cube">Cube</a>
class, which is the basic data representation object in the <em>pya</em>
<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class. In particular, it emphazises some peculiarities
that can lead to complications and finally shows, how <em>pya</em> circumvents
these issues. We shall see, that this does not only reduce the risk of
conversion Errors, but even results in a quite significant performance
boost when converting from numerical CF timestamps to
<code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code> time stamps.</p>
<div class="section" id="load-and-some-example-data">
<h3>Load and some example data<a class="headerlink" href="#load-and-some-example-data" title="Permalink to this headline">¶</a></h3>
<p>Get and load test data file using the new pya interface (the underlying
datatype of <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> is <code class="docutils literal notranslate"><span class="pre">iris.cube.Cube</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">testfiles</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="n">fpath_ecmwf</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">][</span><span class="s1">&#39;ecmwf_osuite&#39;</span><span class="p">]</span>
<span class="n">fpath_aatsr</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">][</span><span class="s1">&#39;aatsr_su_v4.3&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">988</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">basemap</span> <span class="n">extension</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">installed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">imported</span><span class="o">.</span> <span class="n">Some</span> <span class="n">features</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">available</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">819</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">geopy</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span><span class="o">.</span> <span class="n">Aeolus</span> <span class="n">data</span> <span class="n">read</span> <span class="ow">not</span> <span class="n">enabled</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_ecmwf</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath_ecmwf</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
<span class="n">data_aatsr</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath_aatsr</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;AATSR&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">927</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">File</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span> <span class="n">contains</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">data</span> <span class="n">field</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Black</span> <span class="n">Carbon</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Sulphate</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">Organic</span> <span class="n">Matter</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that, if the longitudes are defined on a 0 -&gt; 360 degree grid, they
are automatically converted to -180 -&gt; 180 (the case of the ECMWF data).</p>
</div>
<div class="section" id="digging-into-the-time-representation-of-the-iris-cube-datatype">
<h3>Digging into the time representation of the iris Cube datatype<a class="headerlink" href="#digging-into-the-time-representation-of-the-iris-cube-datatype" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is based on the <code class="docutils literal notranslate"><span class="pre">iris.Cube</span></code> object, which
can be accessed via the <code class="docutils literal notranslate"><span class="pre">grid</span></code> attribute. In the following, some
features of the <code class="docutils literal notranslate"><span class="pre">Cube</span></code> class are introduced.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cube_ecmwf</span> <span class="o">=</span> <span class="n">data_ecmwf</span><span class="o">.</span><span class="n">grid</span>
<span class="n">cube_aatsr</span> <span class="o">=</span> <span class="n">data_aatsr</span><span class="o">.</span><span class="n">grid</span>
</pre></div>
</div>
<div class="section" id="peculiarities-of-time-handling-when-using-the-cube-interface">
<h4>Peculiarities of time handling when using the <code class="docutils literal notranslate"><span class="pre">Cube</span></code> interface<a class="headerlink" href="#peculiarities-of-time-handling-when-using-the-cube-interface" title="Permalink to this headline">¶</a></h4>
<p>Starting with how time is handled. The time is represented as numerical
value relative to a basic date and frequency unit and in the optimum
case, also the specification of a calendar, according to the <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.6/build/cf-conventions.html#time-coordinate">NetCDF CF
conventions</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_ecmwf</span> <span class="o">=</span> <span class="n">cube_ecmwf</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ECMWF</span><span class="se">\n</span><span class="s2">First point:</span><span class="si">%s</span><span class="se">\n</span><span class="s2">Time unit: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Calendar: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                               <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                               <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">calendar</span><span class="p">))</span>
<span class="n">times_aatsr</span><span class="o">=</span> <span class="n">cube_aatsr</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AATSR</span><span class="se">\n</span><span class="s2">First point:</span><span class="si">%s</span><span class="se">\n</span><span class="s2">Time unit: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Calendar: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">times_aatsr</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                             <span class="n">times_aatsr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                             <span class="n">times_aatsr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">calendar</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ECMWF</span>
<span class="n">First</span> <span class="n">point</span><span class="p">:</span><span class="mf">0.0</span>
<span class="n">Time</span> <span class="n">unit</span><span class="p">:</span> <span class="n">day</span> <span class="n">since</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.00000000</span> <span class="n">UTC</span>
<span class="n">Calendar</span><span class="p">:</span> <span class="n">gregorian</span>

<span class="n">AATSR</span>
<span class="n">First</span> <span class="n">point</span><span class="p">:</span><span class="mf">0.0</span>
<span class="n">Time</span> <span class="n">unit</span><span class="p">:</span> <span class="n">day</span> <span class="n">since</span> <span class="mi">2008</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.00000000</span> <span class="n">UTC</span>
<span class="n">Calendar</span><span class="p">:</span> <span class="n">julian</span>
</pre></div>
</div>
<p>Note that the AATSR data is defined using a Julian calendar. The actual
time objects are instances of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> class of the iris
package.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">times_aatsr</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;iris.coords.DimCoord&#39;&gt; &lt;class &#39;iris.coords.DimCoord&#39;&gt;
</pre></div>
</div>
<p>Now, if we want to convert these numerically represented time stamps
into datetime-like objects that, for instance, the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library
understands, we have several options. The first one, which is the most
obvious one, is using the provided iris interface which does the
conversion for us, that is, using the <code class="docutils literal notranslate"><span class="pre">cell(index)</span></code> method (with the
corresponding <code class="docutils literal notranslate"><span class="pre">index</span></code>) of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> class in combination with
the <code class="docutils literal notranslate"><span class="pre">cells()</span></code> iterator method. However, as we shall see below, this is
not only the slowest solution but it is also prone to errors in case the
calendar is not standard (e.g.&nbsp;Julian).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0_ecmwf</span> <span class="o">=</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">point</span>
<span class="n">t0_aatsr</span> <span class="o">=</span> <span class="n">times_aatsr</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">point</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First time stamp ECMWF </span><span class="si">%s</span><span class="s2"> (data type: </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First time stamp AATSR </span><span class="si">%s</span><span class="s2"> (data type: </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>First time stamp ECMWF 2018-01-01 00:00:00 (data type: &lt;class &#39;datetime.datetime&#39;&gt;)
First time stamp AATSR 2008-01-01 00:00:00 (data type: &lt;class &#39;netcdftime._netcdftime.DatetimeJulian&#39;&gt;)
</pre></div>
</div>
<p>As you can see, the <code class="docutils literal notranslate"><span class="pre">cell</span></code> method returns different datatypes,
dependent on the CF unit convention, that is, a standard Python
<code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> object, if the calendar is Gregorian, and a
<code class="docutils literal notranslate"><span class="pre">netcdftime._netcdftime.DatetimeJulian</span></code> object in case of a Julian
calendar. Problem here is, that the former is understood by pandas,
while the latter is not.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>

<span class="n">t0_ecmwf_pandas</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">t0_aatsr_pandas</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot convert input [2008-01-01 00:00:00] of type &lt;class &#39;netcdftime._netcdftime.DatetimeJulian&#39;&gt; to Timestamp&quot;</span><span class="p">,)</span>
</pre></div>
</div>
<p>Nontheless, numpy is easier in that sense, since it understands both
datatypes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">t0_ecmwf_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">)</span>
<span class="n">t0_aatsr_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t0_ecmwf_np</span><span class="p">,</span> <span class="n">t0_aatsr_np</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="mi">2008</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>
</pre></div>
</div>
<p>Fair enough, but however, in the end we want to ensure to have a
conversion method ready that handles any calendar, and that is
considerably fast. We just saw, that <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> works for both
datetime formats that we get when calling the <code class="docutils literal notranslate"><span class="pre">cell</span></code> method of the
<code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> object that holds the time stamps. However, keep in mind,
that whenever <code class="docutils literal notranslate"><span class="pre">cell</span></code> is called, it performs a conversion of the
numeric value into either <code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> or, for non-standard
calendars, into a datetime object from the
<a class="reference external" href="https://github.com/Unidata/cftime">cftime</a> package. So, either way,
when using the <code class="docutils literal notranslate"><span class="pre">cell</span></code> method we have to iterate over all indices to
convert the numerical values into datetime-like objects. The latter may
be done using the <code class="docutils literal notranslate"><span class="pre">cells()</span></code> iterator of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_ecmwf_conv</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
<span class="n">times_aatsr_conv</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_aatsr</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
<span class="c1">#display first two</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">times_ecmwf_conv</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">times_aatsr_conv</span><span class="p">[:</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>

<span class="p">[</span><span class="n">netcdftime</span><span class="o">.</span><span class="n">_netcdftime</span><span class="o">.</span><span class="n">DatetimeJulian</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">netcdftime</span><span class="o">.</span><span class="n">_netcdftime</span><span class="o">.</span><span class="n">DatetimeJulian</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
<p>This worked, but however, is it fast?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[t.point for t in times_ecmwf.cells()]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>120 ms ± 773 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[t.point for t in times_aatsr.cells()]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>106 ms ± 1.35 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>The answer is: No, it is not fast, and furthermore, the latter datatype
will not be accepted by pandas as a valid datetime object. We can,
however, convert the datapoints to numpy datetime64 objects during the
conversion (if we want).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[np.datetime64(t.point) for t in times_ecmwf.cells()]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>122 ms ± 785 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[np.datetime64(t.point) for t in times_aatsr.cells()]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>106 ms ± 833 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>That looks okay, since it does not lead to a notable decrease in the
performance and ensures, that pandas will understand the datatype.
However, about 100ms for conversion of 365 dates is rather slow.</p>
</div>
<div class="section" id="other-options-to-convert-timestamps">
<h4>Other options to convert timestamps<a class="headerlink" href="#other-options-to-convert-timestamps" title="Permalink to this headline">¶</a></h4>
<p>Above we saw how we can convert the numerical timestamps into an array
of numpy <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> objects (which is what we want in the end). As
we shall see below, the conversion can be significantly accelarated if
we do not use the iris interface provided by the <code class="docutils literal notranslate"><span class="pre">cell(index)</span></code> method
and the <code class="docutils literal notranslate"><span class="pre">cells()</span></code> iterator, but rather directly use the underlying
<code class="docutils literal notranslate"><span class="pre">cftime</span></code> library (that iris uses).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[np.datetime64(t) for t in times_ecmwf.units.num2date(times_ecmwf.points)]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1.67 ms ± 6.75 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<p>This is quite an improvement. But if we dig a little deeper, we can
boost this even more, as we shall see in the following. Basically, what
it does is accessing the base date that is encrypted in the unit, i.e.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">day</span> <span class="n">since</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.00000000</span> <span class="n">UTC</span>
</pre></div>
</div>
<p>and based on this base date, and the encrypted temporal resolution (here
<em>day</em>) uses the <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.14.0/reference/arrays.datetime.html">pure numpy datetime
functionality</a>
to convert the stuff. For this, we have to test if the first sub string
(here <em>day</em>) is valid according to the CF standard, which we do using
some features from the <code class="docutils literal notranslate"><span class="pre">netCDF4</span></code> package and by defining a function,
that translates the numerical timestamps into <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> objects
based on the information encoded in the units string(e.g. <em>day since
2018-01-01 00:00:00.00000000 UTC</em>) and the corresponding calendar (e.g.
“gregorian”).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cf_units</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">MINYEAR</span><span class="p">,</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">asarray</span><span class="p">,</span> <span class="n">datetime64</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="k">import</span> <span class="p">(</span><span class="n">microsec_units</span><span class="p">,</span> <span class="n">millisec_units</span><span class="p">,</span> <span class="n">sec_units</span><span class="p">,</span> <span class="n">min_units</span><span class="p">,</span>
                    <span class="n">hr_units</span><span class="p">,</span> <span class="n">day_units</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">netCDF4._netCDF4</span> <span class="k">import</span> <span class="n">_dateparse</span>
<span class="c1"># Start of the gregorian calendar</span>
<span class="c1"># adapted from here: https://github.com/Unidata/cftime/blob/master/cftime/_cftime.pyx</span>
<span class="n">GREGORIAN_BASE</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">1582</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">cftime_to_datetime64</span><span class="p">(</span><span class="n">timesnum</span><span class="p">,</span> <span class="n">cfunit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert numerical timestamps with epoch to numpy datetime64</span>

<span class="sd">    This method was designed to enhance the performance of datetime conversions</span>
<span class="sd">    and is based on the corresponding information provided in the cftime</span>
<span class="sd">    package (`see here &lt;https://github.com/Unidata/cftime/blob/master/cftime/</span>
<span class="sd">    _cftime.pyx&gt;`__). Particularly, this object does, what the :func:`num2date`</span>
<span class="sd">    therein does, but faster, in case the time stamps are not defined on a non</span>
<span class="sd">    standard calendar.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    timesnum : :obj:`list` or :obj:`ndarray`</span>
<span class="sd">        array containing numerical time stamps (relative to basedate of</span>
<span class="sd">        ``cfunit``). Can also be a single number.</span>
<span class="sd">    cfunit : :obj:`str` or :obj:`Unit`</span>
<span class="sd">        CF unit string (e.g. day since 2018-01-01 00:00:00.00000000 UTC) or</span>
<span class="sd">        unit</span>
<span class="sd">    calendar : :obj:`str`, optional</span>
<span class="sd">        string specifying calendar (only required if ``cfunit`` is of type</span>
<span class="sd">        ``str``).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ndarray</span>
<span class="sd">        numpy array containing timestamps as datetime64 objects</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        if cfunit is ``str`` and calendar is not provided or invalid, or if</span>
<span class="sd">        the cfunit string is invalid</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>

<span class="sd">    &gt;&gt;&gt; cfunit_str = &#39;day since 2018-01-01 00:00:00.00000000 UTC&#39;</span>
<span class="sd">    &gt;&gt;&gt; cftime_to_datetime64(10, cfunit_str, &quot;gregorian&quot;)</span>
<span class="sd">    array([&#39;2018-01-11T00:00:00.000000&#39;], dtype=&#39;datetime64[us]&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">timesnum</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">timesnum</span> <span class="o">=</span> <span class="p">[</span><span class="n">timesnum</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfunit</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">calendar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Require specification of calendar for &quot;</span>
                             <span class="s2">&quot;conversion into datetime64 objects&quot;</span><span class="p">)</span>
        <span class="n">cfunit</span> <span class="o">=</span> <span class="n">Unit</span><span class="p">(</span><span class="n">cfunit</span><span class="p">,</span> <span class="n">calendar</span><span class="p">)</span> <span class="c1">#raises Error if calendar is invalid</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfunit</span><span class="p">,</span> <span class="n">Unit</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide cfunit either as instance of class &quot;</span>
                         <span class="s2">&quot;cf_units.Unit or as a string&quot;</span><span class="p">)</span>
    <span class="n">cfu_str</span><span class="p">,</span> <span class="n">calendar</span> <span class="o">=</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">calendar</span>
    <span class="n">basedate</span> <span class="o">=</span> <span class="n">_dateparse</span><span class="p">(</span><span class="n">cfu_str</span><span class="p">)</span>
    <span class="n">cfu_str</span> <span class="o">=</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">name</span>
    <span class="n">basedate</span> <span class="o">=</span> <span class="n">_dateparse</span><span class="p">(</span><span class="n">cfu_str</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;proleptic_gregorian&#39;</span> <span class="ow">and</span> <span class="n">basedate</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="n">MINYEAR</span><span class="p">)</span> <span class="ow">or</span>
        <span class="p">(</span><span class="n">calendar</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;gregorian&#39;</span><span class="p">,</span><span class="s1">&#39;standard&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">basedate</span> <span class="o">&gt;</span> <span class="n">GREGORIAN_BASE</span><span class="p">)):</span>
        <span class="n">cfu_str</span> <span class="o">=</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">name</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">cfu_str</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">microsec_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;us&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">millisec_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;ms&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">sec_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">min_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">hr_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;h&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">day_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;D&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;unsupported time units&#39;</span><span class="p">)</span>

        <span class="n">basedate</span> <span class="o">=</span> <span class="n">datetime64</span><span class="p">(</span><span class="n">basedate</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">basedate</span> <span class="o">+</span> <span class="n">asarray</span><span class="p">(</span><span class="n">timesnum</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;timedelta64[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span><span class="k">tstr</span>)
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">asarray</span><span class="p">([</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">timesnum</span><span class="p">)])</span>
</pre></div>
</div>
<p>Now let’s see how this one performs.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
cftime_to_datetime64(times_ecmwf.points, times_ecmwf.units)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>55.5 µs ± 867 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-pya-does-it">
<h3>How pya does it<a class="headerlink" href="#how-pya-does-it" title="Permalink to this headline">¶</a></h3>
<p>Due to this significant increase in performance for standard calendars
(compared to the methods used in netCDF4), the above method was
implemented in the pya package (<a class="reference external" href="aerocom.met.no/pya/api.html#pya.helpers.cftime_to_datetime64">see
here</a>).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyaerocom.helpers</span> <span class="k">import</span> <span class="n">cftime_to_datetime64</span> <span class="k">as</span> <span class="n">pya_tconversion</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
pya_tconversion(times_ecmwf.points, times_ecmwf.units)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>341 µs ± 6.79 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<p>For the AATSR data, the method is slower, since here, the slower
<code class="docutils literal notranslate"><span class="pre">num2date</span></code> method is used.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
pya_tconversion(times_aatsr.points, times_aatsr.units)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2.11 ms ± 24.9 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<p>Now this is an improvement. Starting with around 100ms when using the
iris interface (i.e.&nbsp;iterating over <code class="docutils literal notranslate"><span class="pre">cells</span></code> of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code>), for
conversion of 365 time stamps, we ended up with the order of 10
microseconds. And at the same time the new method ensures that we have
them in a format that also pandas understands.</p>
<p>The method is also the standard conversion method in the
<code class="docutils literal notranslate"><span class="pre">GriddedData.time_stamps()</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
data_ecmwf.time_stamps()
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>382 µs ± 4.78 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
data_aatsr.time_stamps()
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2.18 ms ± 33.5 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
<div class="section" id="tutorial-showing-how-to-read-ebas-nasa-ames-files">
<h2>Tutorial showing how to read EBAS NASA Ames files<a class="headerlink" href="#tutorial-showing-how-to-read-ebas-nasa-ames-files" title="Permalink to this headline">¶</a></h2>
<p><strong>Note</strong>: this notebook is currently under development</p>
<p>Please see
<a class="reference external" href="https://ebas-submit.nilu.no/Submit-Data/Getting-started">here</a> for
information related to the EBAS NASA Ames file format.</p>
<p><strong>Further links</strong>: - <a class="reference external" href="http://aerocom.met.no/pyaerocom/">Pyaerocom
website</a> - <a class="reference external" href="http://aerocom.met.no/pyaerocom/readme.html#installation">Pyaerocom installation
instructions</a>
- <a class="reference external" href="http://aerocom.met.no/pyaerocom/notebooks.html#getting-started">Getting
started</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pyaerocom.io</span> <span class="k">import</span> <span class="n">EbasNasaAmesFile</span>

<span class="n">ebasdir</span> <span class="o">=</span> <span class="s2">&quot;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/EBASMultiColumn/data/data/&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;DE0043G.20080101000000.20160708144500.nephelometer..aerosol.1y.1h.DE09L_tsi_neph_3563.DE09L_nephelometer.lev2.nas&quot;</span>

<span class="n">mc</span> <span class="o">=</span> <span class="n">EbasNasaAmesFile</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">ebasdir</span><span class="o">+</span><span class="n">filename</span><span class="p">,</span>
                      <span class="n">only_head</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>          <span class="c1">#set True if you only want to import header</span>
                      <span class="n">replace_invalid_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#replace invalid values with NaNs</span>
                      <span class="n">convert_timestamps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1">#compute datetime64 timestamps from numerical values</span>
                      <span class="n">decode_flags</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>        <span class="c1">#decode all flags (e.g. 0.111222333 -&gt; 111 222 333)</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">48</span><span class="p">,</span><span class="mi">246</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">basemap</span> <span class="n">extension</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">installed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">imported</span><span class="o">.</span> <span class="n">Some</span> <span class="n">features</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">available</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">112</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">geopy</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span><span class="o">.</span> <span class="n">Aeolus</span> <span class="n">data</span> <span class="n">read</span> <span class="ow">not</span> <span class="n">enabled</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">121</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">header</span> <span class="n">row</span> <span class="mf">6.</span>
<span class="mi">2008</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2016</span> <span class="mi">07</span> <span class="mi">08</span>

<span class="n">Error</span> <span class="n">msg</span><span class="p">:</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;list index out of range&#39;</span><span class="p">,)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">EbasNasaAmesFile</span>
<span class="o">--------------------------</span>

   <span class="n">num_head_lines</span><span class="p">:</span> <span class="mi">60</span>
   <span class="n">num_head_fmt</span><span class="p">:</span> <span class="mi">1001</span>
   <span class="n">data_originator</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span>
   <span class="n">sponsor_organisation</span><span class="p">:</span> <span class="n">DE09L</span><span class="p">,</span> <span class="n">Deutscher</span> <span class="n">Wetterdienst</span><span class="p">,</span> <span class="n">DWD</span><span class="p">,</span> <span class="n">Met</span><span class="o">.</span> <span class="n">Obs</span><span class="o">.</span><span class="p">,</span> <span class="n">Hohenspeissenberg</span><span class="p">,</span> <span class="p">,</span> <span class="mi">82283</span><span class="p">,</span> <span class="n">Hohenspeissenberg</span><span class="p">,</span> <span class="n">Germany</span>
   <span class="n">submitter</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span>
   <span class="n">project_association</span><span class="p">:</span> <span class="n">EUSAAR</span> <span class="n">GAW</span><span class="o">-</span><span class="n">WDCA</span>
   <span class="n">vol_num</span><span class="p">:</span> <span class="mi">1</span>
   <span class="n">vol_totnum</span><span class="p">:</span> <span class="mi">1</span>
   <span class="n">ref_date</span><span class="p">:</span> <span class="mi">2008</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2016</span> <span class="mi">07</span> <span class="mi">08</span>
   <span class="n">revision_date</span><span class="p">:</span> <span class="n">nan</span>
   <span class="n">freq</span><span class="p">:</span> <span class="mf">0.041667</span>
   <span class="n">descr_time_unit</span><span class="p">:</span> <span class="n">days</span> <span class="kn">from</span> <span class="nn">file</span> <span class="n">reference</span> <span class="n">point</span>
   <span class="n">num_cols_dependent</span><span class="p">:</span> <span class="mi">11</span>
   <span class="n">mul_factors</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">11</span> <span class="n">items</span><span class="p">)</span>
   <span class="p">[</span><span class="mf">1.0</span>
    <span class="mf">1.0</span>
    <span class="o">...</span>
    <span class="mf">1.0</span>
    <span class="mf">1.0</span><span class="p">]</span>

   <span class="n">vals_invalid</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">11</span> <span class="n">items</span><span class="p">)</span>
   <span class="p">[</span><span class="mf">999.999999</span>
    <span class="mf">999.999</span>
    <span class="o">...</span>
    <span class="mf">9999.9</span>
    <span class="mf">9.999999999</span><span class="p">]</span>

   <span class="n">descr_first_col</span><span class="p">:</span> <span class="n">end_time</span> <span class="n">of</span> <span class="n">measurement</span><span class="p">,</span> <span class="n">days</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">file</span> <span class="n">reference</span> <span class="n">point</span>

   <span class="n">Column</span> <span class="n">variable</span> <span class="n">definitions</span>
   <span class="o">-------------------------------</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">days</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">days</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">hPa</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">relative_humidity</span><span class="p">,</span> <span class="n">unit</span><span class="o">=%</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">no</span> <span class="n">unit</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="p">,</span>

   <span class="n">EBAS</span> <span class="n">meta</span> <span class="n">data</span>
   <span class="o">------------------</span>
   <span class="n">verbose</span><span class="p">:</span> <span class="kc">False</span>
   <span class="n">data_definition</span><span class="p">:</span> <span class="n">EBAS_1</span><span class="o">.</span><span class="mi">1</span>
   <span class="n">set_type_code</span><span class="p">:</span> <span class="n">TU</span>
   <span class="n">timezone</span><span class="p">:</span> <span class="n">UTC</span>
   <span class="n">file_name</span><span class="p">:</span> <span class="n">DE0043G</span><span class="o">.</span><span class="mf">20080101000000.20160708144500</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">DE09L_tsi_neph_3563</span><span class="o">.</span><span class="n">DE09L_nephelometer</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span>
   <span class="n">file_creation</span><span class="p">:</span> <span class="mi">20180101031050</span>
   <span class="n">startdate</span><span class="p">:</span> <span class="mi">20080101000000</span>
   <span class="n">revision_date</span><span class="p">:</span> <span class="mi">20160708144500</span>
   <span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>
   <span class="n">data_level</span><span class="p">:</span> <span class="mi">2</span>
   <span class="n">period_code</span><span class="p">:</span> <span class="mi">1</span><span class="n">y</span>
   <span class="n">resolution_code</span><span class="p">:</span> <span class="mi">1</span><span class="n">h</span>
   <span class="n">station_code</span><span class="p">:</span> <span class="n">DE0043G</span>
   <span class="n">platform_code</span><span class="p">:</span> <span class="n">DE0043S</span>
   <span class="n">station_name</span><span class="p">:</span> <span class="n">Hohenpeissenberg</span>
   <span class="n">station_wdca</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span> <span class="n">GAWADE__HPB</span>
   <span class="n">station_gaw</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span> <span class="n">HPB</span>
   <span class="n">station_gaw</span><span class="o">-</span><span class="n">name</span><span class="p">:</span> <span class="n">Hohenpeissenberg</span>
   <span class="n">station_land_use</span><span class="p">:</span> <span class="n">Grassland</span>
   <span class="n">station_setting</span><span class="p">:</span> <span class="n">Mountain</span>
   <span class="n">station_gaw_type</span><span class="p">:</span> <span class="n">G</span>
   <span class="n">station_wmo_region</span><span class="p">:</span> <span class="mi">6</span>
   <span class="n">station_latitude</span><span class="p">:</span> <span class="mf">47.8014984131</span>
   <span class="n">station_longitude</span><span class="p">:</span> <span class="mf">11.0096197128</span>
   <span class="n">station_altitude</span><span class="p">:</span> <span class="mf">985.0</span> <span class="n">m</span>
   <span class="n">regime</span><span class="p">:</span> <span class="n">IMG</span>
   <span class="n">component</span><span class="p">:</span>
   <span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
   <span class="n">matrix</span><span class="p">:</span> <span class="n">aerosol</span>
   <span class="n">laboratory_code</span><span class="p">:</span> <span class="n">DE09L</span>
   <span class="n">instrument_type</span><span class="p">:</span> <span class="n">nephelometer</span>
   <span class="n">instrument_name</span><span class="p">:</span> <span class="n">tsi_neph_3563</span>
   <span class="n">method_ref</span><span class="p">:</span> <span class="n">DE09L_nephelometer</span>
   <span class="n">originator</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span><span class="p">,</span> <span class="n">Harald</span><span class="o">.</span><span class="n">Flentje</span><span class="nd">@dwd</span><span class="o">.</span><span class="n">de</span><span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span>
   <span class="n">submitter</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span><span class="p">,</span> <span class="n">Harald</span><span class="o">.</span><span class="n">Flentje</span><span class="nd">@dwd</span><span class="o">.</span><span class="n">de</span><span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span>

   <span class="n">Data</span>
   <span class="o">--------</span>
<span class="p">[[</span><span class="mf">0.00000000e+00</span> <span class="mf">4.16670000e-02</span>            <span class="n">nan</span> <span class="o">...</span>            <span class="n">nan</span>
             <span class="n">nan</span> <span class="mf">3.94999000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">4.16670000e-02</span> <span class="mf">8.33330000e-02</span>            <span class="n">nan</span> <span class="o">...</span>            <span class="n">nan</span>
             <span class="n">nan</span> <span class="mf">3.94999000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">8.33330000e-02</span> <span class="mf">1.25000000e-01</span>            <span class="n">nan</span> <span class="o">...</span>            <span class="n">nan</span>
             <span class="n">nan</span> <span class="mf">3.94999000e-01</span><span class="p">]</span>
 <span class="o">...</span>
 <span class="p">[</span><span class="mf">3.65875000e+02</span> <span class="mf">3.65916667e+02</span> <span class="mf">4.75900000e+00</span> <span class="o">...</span> <span class="mf">8.50000000e+00</span>
  <span class="mf">2.99900000e+02</span> <span class="mf">2.47000000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">3.65916667e+02</span> <span class="mf">3.65958310e+02</span> <span class="mf">5.16200000e+00</span> <span class="o">...</span> <span class="mf">8.70000000e+00</span>
  <span class="mf">2.99900000e+02</span> <span class="mf">2.47000000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">3.65958333e+02</span> <span class="mf">3.66000000e+02</span> <span class="mf">5.31800000e+00</span> <span class="o">...</span> <span class="mf">9.30000000e+00</span>
  <span class="mf">2.99700000e+02</span> <span class="mf">0.00000000e+00</span><span class="p">]]</span>
<span class="n">Colnum</span><span class="p">:</span> <span class="mi">12</span>
<span class="n">Timestamps</span><span class="p">:</span> <span class="mi">8784</span>
</pre></div>
</div>
<div class="section" id="column-information">
<h3>Column information<a class="headerlink" href="#column-information" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">print_col_info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Column</span> <span class="mi">0</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">starttime</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">days</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span>

<span class="n">Column</span> <span class="mi">1</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">endtime</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">days</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span>

<span class="n">Column</span> <span class="mi">2</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">3</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">4</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">5</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">6</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">7</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">8</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">pressure</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">hPa</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">location</span><span class="p">:</span> <span class="n">instrument</span> <span class="n">internal</span>

<span class="n">Column</span> <span class="mi">9</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">relative_humidity</span>
<span class="n">unit</span><span class="p">:</span> <span class="o">%</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">location</span><span class="p">:</span> <span class="n">instrument</span> <span class="n">internal</span>

<span class="n">Column</span> <span class="mi">10</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">temperature</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">K</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">location</span><span class="p">:</span> <span class="n">instrument</span> <span class="n">internal</span>

<span class="n">Column</span> <span class="mi">11</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">no</span> <span class="n">unit</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">flag_id</span><span class="p">:</span>
</pre></div>
</div>
<p>You can see that all variable columns were assigned the same flag
column, since there is only one. This would be different if there were
multiple flag columns (e.g.&nbsp;one for each variable).</p>
</div>
<div class="section" id="access-flag-information">
<h3>Access flag information<a class="headerlink" href="#access-flag-information" title="Permalink to this headline">¶</a></h3>
<p>You can access the flags for each column using the <code class="docutils literal notranslate"><span class="pre">flags</span></code> attribute
of the file.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">flags</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;numflag&#39;</span><span class="p">,</span>
              <span class="o">&lt;</span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ebas_nasa_ames</span><span class="o">.</span><span class="n">EbasFlagCol</span> <span class="n">at</span> <span class="mh">0x7f5703050898</span><span class="o">&gt;</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="s2">&quot;numflag&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>The raw flags can be accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">raw_data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.394999</span><span class="p">,</span> <span class="mf">0.394999</span><span class="p">,</span> <span class="mf">0.394999</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.247</span>   <span class="p">,</span> <span class="mf">0.247</span>   <span class="p">,</span> <span class="mf">0.</span>      <span class="p">])</span>
</pre></div>
</div>
<p>And the processed flags are in stored in a (Nx3) numpy array where N is
the total number of timestamps.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">flags</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">394</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">394</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">394</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="o">...</span><span class="p">,</span>
       <span class="p">[</span><span class="mi">247</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">247</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<p>For instance, access the flags of the 5 timestamp:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">394</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="convert-object-to-pandas-dataframe">
<h3>Convert object to pandas Dataframe<a class="headerlink" href="#convert-object-to-pandas-dataframe" title="Permalink to this headline">¶</a></h3>
<p>The conversion does currently exclude all flag columns</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aerosol_light_backscattering_coefficient</th>
      <th>aerosol_light_backscattering_coefficient</th>
      <th>aerosol_light_backscattering_coefficient</th>
      <th>aerosol_light_scattering_coefficient</th>
      <th>aerosol_light_scattering_coefficient</th>
      <th>aerosol_light_scattering_coefficient</th>
      <th>pressure</th>
      <th>relative_humidity</th>
      <th>temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2008-01-01 00:30:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2008-01-01 01:29:59</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2008-01-01 02:29:59</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2008-01-01 03:30:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2008-01-01 04:29:59</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="ebas-file-query-and-database-browser">
<h2>EBAS file query and database browser<a class="headerlink" href="#ebas-file-query-and-database-browser" title="Permalink to this headline">¶</a></h2>
<p>The previous tutorial showed how to read EBAS NASA Ames files and gave
insights into the structure of these files. However, this did not
include the specification of an actual data request (for instance: get
data from all stations in the arctic that contain measurements of the
AOD between 2010 and 2016).</p>
<p>In this tutorial, we show, how such requests can be specified easily in
pyaerocom and how the database can be browsed for instance by variable
name, type of instrument, location or other relevant parameters.</p>
<p>The notebook is categorised as follows:</p>
<ul class="simple">
<li>Defining a request</li>
<li>Retrieve all files for a request</li>
<li>Browse the database</li>
</ul>
<div class="section" id="specifying-a-request">
<h3>Specifying a request<a class="headerlink" href="#specifying-a-request" title="Permalink to this headline">¶</a></h3>
<p>Request parameters can be specified using the <code class="docutils literal notranslate"><span class="pre">EbasSQLRequest</span></code> class.
E.g.:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ebas_file_index</span><span class="o">.</span><span class="n">EbasSQLRequest</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span>
                                                             <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span>
                                                             <span class="s1">&#39;pressure&#39;</span><span class="p">),</span>
                                                  <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">,</span>
                                                  <span class="n">stop_date</span><span class="o">=</span><span class="s2">&quot;2011-01-01&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">51</span><span class="p">,</span><span class="mi">808</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">basemap</span> <span class="n">extension</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">installed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">imported</span><span class="o">.</span> <span class="n">Some</span> <span class="n">features</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">available</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSun2</span><span class="o">.</span><span class="mf">0.</span><span class="n">SDA</span><span class="o">.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="n">OBS</span> <span class="n">directory</span> <span class="n">path</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span><span class="mi">653</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">geopy</span> <span class="n">library</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span><span class="o">.</span> <span class="n">Aeolus</span> <span class="n">data</span> <span class="n">read</span> <span class="ow">not</span> <span class="n">enabled</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">EbasSQLRequest</span>
<span class="o">------------------------</span>
<span class="n">variables</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
<span class="n">start_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">stop_date</span><span class="p">:</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">station_names</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">matrices</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">altitude_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lon_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lat_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">instrument_types</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">statistics</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">Filename</span> <span class="n">request</span> <span class="n">string</span><span class="p">:</span>
<span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>You can also output the actual SQL query string:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">make_query_str</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>The request class is an extended dictionary and can thus be used like a
dictionary:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">instrument_types</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;nephelometer&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">EbasSQLRequest</span>
<span class="o">------------------------</span>
<span class="n">variables</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
<span class="n">start_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">stop_date</span><span class="p">:</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">station_names</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">matrices</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">altitude_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lon_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lat_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">instrument_types</span><span class="p">:</span> <span class="n">nephelometer</span>
<span class="n">statistics</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">Filename</span> <span class="n">request</span> <span class="n">string</span><span class="p">:</span>
<span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">instr_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;nephelometer&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="execution-of-file-request-query">
<h3>Execution of file request query<a class="headerlink" href="#execution-of-file-request-query" title="Permalink to this headline">¶</a></h3>
<p>Now that we have defined which files we would like to look into, we can
execute the query and retrieve all files that match our specifications.
This can be done with the <code class="docutils literal notranslate"><span class="pre">EbasFileIndex</span></code> class:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">EbasFileIndex</span><span class="p">()</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of files found:</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Request:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">files</span> <span class="n">found</span><span class="p">:</span><span class="mi">56</span>
<span class="n">Request</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">EbasSQLRequest</span>
<span class="o">------------------------</span>
<span class="n">variables</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
<span class="n">start_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">stop_date</span><span class="p">:</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">station_names</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">matrices</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">altitude_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lon_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lat_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">instrument_types</span><span class="p">:</span> <span class="n">nephelometer</span>
<span class="n">statistics</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">Filename</span> <span class="n">request</span> <span class="n">string</span><span class="p">:</span>
<span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">instr_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;nephelometer&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3>Browsing the database<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">EbasFileIndex</span></code> class provides some convenience function that
allow to browse meta information for a given request. These are
illustrated in the following:</p>
<p>For instance, we can check, what variables could actually be retrieved
in the request:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_variables</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;pressure&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,)]</span>
</pre></div>
</div>
<p>Or what matrices the data contains:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_matrices</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;instrument&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;aerosol&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;pm10&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;pm1&#39;</span><span class="p">,)]</span>
</pre></div>
</div>
<p>Or which station coordinates (lon, lat) the dataset contains:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_coordinates</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">23.583333</span><span class="p">,</span> <span class="mf">42.166667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">79.783839</span><span class="p">,</span> <span class="mf">44.231006</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">122.9576034546</span><span class="p">,</span> <span class="mf">50.059299469</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">104.986864</span><span class="p">,</span> <span class="mf">54.353743</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">62.3415260315</span><span class="p">,</span> <span class="mf">82.4991455078</span><span class="p">),</span> <span class="p">(</span><span class="mf">7.985</span><span class="p">,</span> <span class="mf">46.5475</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.0096197128</span><span class="p">,</span> <span class="mf">47.8014984131</span><span class="p">),</span> <span class="p">(</span><span class="mf">12.93386</span><span class="p">,</span> <span class="mf">51.53014</span><span class="p">),</span> <span class="p">(</span><span class="mf">10.97964</span><span class="p">,</span> <span class="mf">47.4165</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">8.266</span><span class="p">,</span> <span class="o">-</span><span class="mf">70.666</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">16.4994</span><span class="p">,</span> <span class="mf">28.309</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.605</span><span class="p">,</span> <span class="mf">37.164</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.35</span><span class="p">,</span> <span class="mf">41.766667</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.283333</span><span class="p">,</span> <span class="mf">61.85</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.116111111</span><span class="p">,</span> <span class="mf">67.973333333</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.95</span><span class="p">,</span> <span class="mf">45.76667</span><span class="p">),</span> <span class="p">(</span><span class="mf">25.666667</span><span class="p">,</span> <span class="mf">35.316667</span><span class="p">),</span> <span class="p">(</span><span class="mf">19.583333</span><span class="p">,</span> <span class="mf">46.966667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">9.89944</span><span class="p">,</span> <span class="mf">53.32583</span><span class="p">),</span> <span class="p">(</span><span class="mf">77.151389</span><span class="p">,</span> <span class="mf">28.427778</span><span class="p">),</span> <span class="p">(</span><span class="mf">8.633333</span><span class="p">,</span> <span class="mf">45.8</span><span class="p">),</span> <span class="p">(</span><span class="mf">10.7</span><span class="p">,</span> <span class="mf">44.183333</span><span class="p">),</span> <span class="p">(</span><span class="mf">126.17</span><span class="p">,</span> <span class="mf">33.28</span><span class="p">),</span> <span class="p">(</span><span class="mf">4.926389</span><span class="p">,</span> <span class="mf">51.970278</span><span class="p">),</span> <span class="p">(</span><span class="mf">8.252</span><span class="p">,</span> <span class="mf">58.38853</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.888333</span><span class="p">,</span> <span class="mf">78.906667</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.533333</span><span class="p">,</span> <span class="o">-</span><span class="mf">72.016667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">65.618</span><span class="p">,</span> <span class="mf">18.381</span><span class="p">),</span> <span class="p">(</span><span class="mf">13.15</span><span class="p">,</span> <span class="mf">56.016667</span><span class="p">),</span> <span class="p">(</span><span class="mf">120.87</span><span class="p">,</span> <span class="mf">23.47</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">156.6114654541</span><span class="p">,</span> <span class="mf">71.3230133057</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">111.9841</span><span class="p">,</span> <span class="mf">35.9731</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">112.1288</span><span class="p">,</span> <span class="mf">36.0778</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">111.6832</span><span class="p">,</span> <span class="mf">34.3405</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">112.8</span><span class="p">,</span> <span class="mf">31.9506</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">109.3889</span><span class="p">,</span> <span class="mf">32.0097</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">155.5761566162</span><span class="p">,</span> <span class="mf">19.5362300873</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">86.148</span><span class="p">,</span> <span class="mf">37.1317</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">68.2608</span><span class="p">,</span> <span class="mf">44.3772</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">113.9958</span><span class="p">,</span> <span class="mf">48.5103</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">81.7</span><span class="p">,</span> <span class="mf">36.2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">103.1772</span><span class="p">,</span> <span class="mf">29.3022</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">97.5</span><span class="p">,</span> <span class="mf">36.6</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">24.7999992371</span><span class="p">,</span> <span class="o">-</span><span class="mf">89.9969482422</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">124.1510009766</span><span class="p">,</span> <span class="mf">41.0541000366</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">105.5457</span><span class="p">,</span> <span class="mf">40.2783</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">111.9692</span><span class="p">,</span> <span class="mf">35.1406</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">77.04</span><span class="p">,</span> <span class="mf">38.9</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">109.7958</span><span class="p">,</span> <span class="mf">34.9139</span><span class="p">),</span> <span class="p">(</span><span class="mf">18.48968</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.35348</span><span class="p">)]</span>
</pre></div>
</div>
<p>Now, let’s narrow this down:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">lat_range</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_coordinates</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="o">-</span><span class="mf">62.3415260315</span><span class="p">,</span> <span class="mf">82.4991455078</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.283333</span><span class="p">,</span> <span class="mf">61.85</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.116111111</span><span class="p">,</span> <span class="mf">67.973333333</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.888333</span><span class="p">,</span> <span class="mf">78.906667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">156.6114654541</span><span class="p">,</span> <span class="mf">71.3230133057</span><span class="p">)]</span>
</pre></div>
</div>
<p>Print all station names:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_station_names</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;Alert&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Hyytiälä&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Pallas (Sammaltunturi)&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Zeppelin mountain (Ny-Ålesund)&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Barrow&#39;</span><span class="p">,)]</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-browsing">
<h3>Custom browsing<a class="headerlink" href="#custom-browsing" title="Permalink to this headline">¶</a></h3>
<p>The previous browsing methods (e.g. <code class="docutils literal notranslate"><span class="pre">contains_coordinates()</span></code>,
<code class="docutils literal notranslate"><span class="pre">contains_matrices</span></code>, <code class="docutils literal notranslate"><span class="pre">contains_variables</span></code>) are all just simple
wrappers for the general query method <code class="docutils literal notranslate"><span class="pre">make_query_str</span></code> of the
<code class="docutils literal notranslate"><span class="pre">EbasSQLRequest</span></code> class, that is then called by the <code class="docutils literal notranslate"><span class="pre">EbasFileIndex</span></code>
class using the method <code class="docutils literal notranslate"><span class="pre">execute_request</span></code>). Thus, if needed, you may
define your own request simply by using the provided interface. Here an
example using the request constraints specified above. Let’s say we want
to retrieve a list of station names and their coordinates (lon, lat,
alt). This can be done by calling (we store the results in a list named
<code class="docutils literal notranslate"><span class="pre">station_info</span></code>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_str</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">make_query_str</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;station_name&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;station_longitude&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;station_latitude&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;station_altitude&quot;</span><span class="p">))</span>

<span class="n">station_info</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_request</span><span class="p">(</span><span class="n">query_str</span><span class="p">)</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">station_info</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;Alert&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">62.3415260315</span><span class="p">,</span> <span class="mf">82.4991455078</span><span class="p">,</span> <span class="mf">210.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Hyytiälä&#39;</span><span class="p">,</span> <span class="mf">24.283333</span><span class="p">,</span> <span class="mf">61.85</span><span class="p">,</span> <span class="mf">181.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Pallas (Sammaltunturi)&#39;</span><span class="p">,</span> <span class="mf">24.116111111</span><span class="p">,</span> <span class="mf">67.973333333</span><span class="p">,</span> <span class="mf">565.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Zeppelin mountain (Ny-Ålesund)&#39;</span><span class="p">,</span> <span class="mf">11.888333</span><span class="p">,</span> <span class="mf">78.906667</span><span class="p">,</span> <span class="mf">474.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Barrow&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">156.6114654541</span><span class="p">,</span> <span class="mf">71.3230133057</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">)</span>
</pre></div>
</div>
<p>You can see that the results for each station are stored in tuples in
the order of the request.</p>
</div>
<div class="section" id="read-all-files">
<h3>Read all files<a class="headerlink" href="#read-all-files" title="Permalink to this headline">¶</a></h3>
<p>Let’s update the file list and read all files.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of files found: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">files</span> <span class="n">found</span><span class="p">:</span> <span class="mi">7</span>
</pre></div>
</div>
<p>Let’s read the files:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">OBSCONFIG</span><span class="p">[</span><span class="s2">&quot;EBASMC&quot;</span><span class="p">][</span><span class="s2">&quot;PATH&quot;</span><span class="p">],</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">EbasNasaAmesFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">258</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">header</span> <span class="n">row</span> <span class="mf">6.</span>
<span class="mi">2010</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2015</span> <span class="mi">02</span> <span class="mi">09</span>

<span class="n">Error</span> <span class="n">msg</span><span class="p">:</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;list index out of range&#39;</span><span class="p">,)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">578</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">header</span> <span class="n">row</span> <span class="mf">6.</span>
<span class="mi">2010</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2017</span> <span class="mi">05</span> <span class="mi">16</span>

<span class="n">Error</span> <span class="n">msg</span><span class="p">:</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;list index out of range&#39;</span><span class="p">,)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">701</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">header</span> <span class="n">row</span> <span class="mf">6.</span>
<span class="mi">2010</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2012</span> <span class="mi">10</span> <span class="mi">04</span>

<span class="n">Error</span> <span class="n">msg</span><span class="p">:</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;list index out of range&#39;</span><span class="p">,)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">797</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">header</span> <span class="n">row</span> <span class="mf">6.</span>
<span class="mi">2010</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2016</span> <span class="mi">07</span> <span class="mi">05</span>

<span class="n">Error</span> <span class="n">msg</span><span class="p">:</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;list index out of range&#39;</span><span class="p">,)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">855</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">header</span> <span class="n">row</span> <span class="mf">6.</span>
<span class="mi">2010</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2015</span> <span class="mi">02</span> <span class="mi">16</span>

<span class="n">Error</span> <span class="n">msg</span><span class="p">:</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;list index out of range&#39;</span><span class="p">,)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">968</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">header</span> <span class="n">row</span> <span class="mf">6.</span>
<span class="mi">2010</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2015</span> <span class="mi">08</span> <span class="mi">19</span>

<span class="n">Error</span> <span class="n">msg</span><span class="p">:</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;list index out of range&#39;</span><span class="p">,)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">58</span><span class="p">,</span><span class="mi">228</span><span class="p">:</span><span class="n">WARNING</span><span class="p">:</span>
<span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">header</span> <span class="n">row</span> <span class="mf">6.</span>
<span class="mi">2010</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2015</span> <span class="mi">08</span> <span class="mi">19</span>

<span class="n">Error</span> <span class="n">msg</span><span class="p">:</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;list index out of range&#39;</span><span class="p">,)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="readme.html" class="btn btn-neutral" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, met.no.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>